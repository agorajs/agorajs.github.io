{"version":3,"sources":["../node_modules/agora-criteria/dist/utils.js","../node_modules/agora-criteria/dist/node-movement/k-nearest-neighbors.js"],"names":["Object","defineProperty","exports","value","criteriaWrap","_a","name","_criteria","criteria","_short","short","initial","updated","nodes","length","Error","__importDefault","this","mod","__esModule","agora_graph_1","lodash_1","utils_1","createKNearestNeighborsCriteria","k","kNearestNeighbors","initialGraph","updatedGraph","options","initialNodes","updatedNodes","nodesLength","n_k","node","default","sortBy","n","norm","filter","index","slice","map","i","initialNode","updatedNode","Math","pow","intersection","NodeMovement8NearestNeighborsCriteria"],"mappings":"iGAEAA,OAAOC,eAAeC,EAAS,aAAc,CAC3CC,OAAO,IA6BTD,EAAQE,aA1BR,SAAsBC,GACpB,IAAIC,EAAOD,EAAGC,KACVC,EAAYF,EAAGG,SACfC,EAASJ,EAAGK,MAChB,MAAO,CACLJ,KAAMA,EACNI,MAAOD,EACPD,SAAU,SAAkBG,EAASC,GACnC,GAAID,EAAQE,MAAMC,SAAWF,EAAQC,MAAMC,OAUzC,MAAMC,MAAM,aAAeN,GAAkBH,GAAQ,wCAGvD,OAAOC,EAAUI,EAASC,O,iCCzBhC,IAAII,EAAkBC,MAAQA,KAAKD,iBAAmB,SAAUE,GAC9D,OAAOA,GAAOA,EAAIC,WAAaD,EAAM,CACnC,QAAWA,IAIflB,OAAOC,eAAeC,EAAS,aAAc,CAC3CC,OAAO,IAGT,IAAIiB,EAAgB,EAAQ,IAExBC,EAAWL,EAAgB,EAAQ,IAEnCM,EAAU,EAAQ,KAyCtB,SAASC,EAAgCC,GAKvC,YAJU,IAANA,IACFA,EAAI,GAGCF,EAAQlB,aAAa,CAC1BI,SAAU,SAAkBG,EAASC,GACnC,OAAOV,EAAQuB,kBAAkBd,EAASC,EAAS,CACjDY,EAAGA,KAGPlB,KAAM,iBAAmBkB,EAAI,qBAC7Bd,MAAO,MAAQc,EAAI,OA3CvBtB,EAAQuB,kBAAoB,SAAUC,EAAcC,EAAcC,GAQhE,IAPA,IAAIJ,EAAII,EAAQJ,EACZK,EAAeH,EAAab,MAC5BiB,EAAeH,EAAad,MAC5BkB,EAAcF,EAAaf,OAC3BkB,EAcN,SAAWR,GACT,OAAO,SAAUX,EAAOoB,GACtB,OAAOZ,EAASa,QAAQC,OAAOtB,GAAO,SAAUuB,GAC9C,OAAOhB,EAAciB,KAAKJ,EAAMG,MAC/BE,QAAO,SAAUF,GAClB,OAAOA,EAAEG,OAASN,EAAKM,SACtBC,MAAM,EAAGhB,GAAGiB,KAAI,SAAUL,GAC3B,OAAOA,EAAEG,UArBHH,CAAEZ,GACRrB,EAAQ,EAEHuC,EAAI,EAAGA,EAAIX,EAAaW,IAAK,CACpC,IAAIC,EAAcd,EAAaa,GAC3BE,EAAcd,EAAaY,GAC/BvC,GAAS0C,KAAKC,IAAItB,EAAIH,EAASa,QAAQa,aAAaf,EAAIH,EAAcc,GAAcX,EAAIF,EAAcc,IAAc9B,OAAQ,GAG9H,MAAO,CACLX,MAAOA,IAgCXD,EAAQqB,gCAAkCA,EAC1CrB,EAAQ8C,sCAAwCzB,IAChDrB,EAAQgC,QAAUhC,EAAQ8C","file":"static/js/21.37549868.chunk.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction criteriaWrap(_a) {\n  var name = _a.name,\n      _criteria = _a.criteria,\n      _short = _a.short;\n  return {\n    name: name,\n    short: _short,\n    criteria: function criteria(initial, updated) {\n      if (initial.nodes.length !== updated.nodes.length) {\n        //* ignoring console because it's captured by the exception\n\n        /*\r\n        console.error(\r\n        'criteria', // family\r\n        criteria.short, // type\r\n        'abording', // action\r\n        'not the same number of nodes' // reason\r\n        ); */\n        throw Error(\"Criteria \" + (_short ? _short : name) + \" abording : not same number of nodes\");\n      }\n\n      return _criteria(initial, updated);\n    }\n  };\n}\n\nexports.criteriaWrap = criteriaWrap;","\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar agora_graph_1 = require(\"agora-graph\");\n\nvar lodash_1 = __importDefault(require(\"lodash\"));\n\nvar utils_1 = require(\"../utils\");\n/**\r\n * TODO: NNB*16\r\n * @param initialGraph the initial graph sorted by index\r\n * @param updatedGraph the updated graph sorted by index\r\n *\r\n * @returns {{value: number, displacement: Edge[]}}\r\n */\n\n\nexports.kNearestNeighbors = function (initialGraph, updatedGraph, options) {\n  var k = options.k;\n  var initialNodes = initialGraph.nodes;\n  var updatedNodes = updatedGraph.nodes;\n  var nodesLength = initialNodes.length;\n  var n_k = n(k);\n  var value = 0;\n\n  for (var i = 0; i < nodesLength; i++) {\n    var initialNode = initialNodes[i];\n    var updatedNode = updatedNodes[i];\n    value += Math.pow(k - lodash_1.default.intersection(n_k(initialNodes, initialNode), n_k(updatedNodes, updatedNode)).length, 2);\n  }\n\n  return {\n    value: value\n  };\n};\n\nfunction n(k) {\n  return function (nodes, node) {\n    return lodash_1.default.sortBy(nodes, function (n) {\n      return agora_graph_1.norm(node, n);\n    }).filter(function (n) {\n      return n.index != node.index;\n    }).slice(0, k).map(function (n) {\n      return n.index;\n    });\n  };\n}\n\nfunction createKNearestNeighborsCriteria(k) {\n  if (k === void 0) {\n    k = 8;\n  }\n\n  return utils_1.criteriaWrap({\n    criteria: function criteria(initial, updated) {\n      return exports.kNearestNeighbors(initial, updated, {\n        k: k\n      });\n    },\n    name: 'node-movement/' + k + '-nearest-neighbors',\n    short: 'nm_' + k + 'nn'\n  });\n}\n\nexports.createKNearestNeighborsCriteria = createKNearestNeighborsCriteria;\nexports.NodeMovement8NearestNeighborsCriteria = createKNearestNeighborsCriteria();\nexports.default = exports.NodeMovement8NearestNeighborsCriteria;"],"sourceRoot":""}