{"version":3,"sources":["../node_modules/javascript-lp-solver/src/Tableau/Tableau.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/point.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/box.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/vector.js","../node_modules/javascript-lp-solver/src/expressions.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/overlap.js","../node_modules/javascript-lp-solver/src/Tableau/Solution.js","../node_modules/javascript-lp-solver/src/Tableau/branchAndCut.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/index.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/algorithm.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/conversion.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/cropped.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/delaunay-edges.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/distance.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/node-map.js","../node_modules/agora-diamond/node_modules/agora-graph/dist/scale.js","../node_modules/javascript-lp-solver/src/main.js","../node_modules/javascript-lp-solver/src/Tableau/index.js","../node_modules/javascript-lp-solver/src/Tableau/simplex.js","../node_modules/javascript-lp-solver/src/Tableau/MilpSolution.js","../node_modules/javascript-lp-solver/src/Tableau/cuttingStrategies.js","../node_modules/javascript-lp-solver/src/Tableau/dynamicModification.js","../node_modules/javascript-lp-solver/src/Tableau/log.js","../node_modules/javascript-lp-solver/src/Tableau/backup.js","../node_modules/javascript-lp-solver/src/Tableau/branchingStrategies.js","../node_modules/javascript-lp-solver/src/Tableau/integerProperties.js","../node_modules/javascript-lp-solver/src/Model.js","../node_modules/javascript-lp-solver/src/Validation.js","../node_modules/javascript-lp-solver/src/Reformat.js","../node_modules/javascript-lp-solver/src/Polyopt.js","../node_modules/agora-diamond/dist/index.js"],"names":["Solution","MilpSolution","Tableau","precision","this","model","matrix","width","height","costRowIndex","rhsColumn","variablesPerIndex","unrestrictedVars","feasible","evaluation","varIndexByRow","varIndexByCol","rowByVarIndex","colByVarIndex","optionalObjectives","objectivesByPriority","savedState","availableIndexes","lastElementIndex","variables","nVars","bounded","unboundedVarIndex","branchAndCutIterations","OptionalObjective","priority","nColumns","reducedCosts","Array","c","module","exports","prototype","solve","getNumberOfIntegerVariables","branchAndCut","simplex","updateVariableValues","getSolution","copy","length","slice","setOptionalObjective","column","cost","objectiveForPriority","undefined","Math","max","push","sort","a","b","initialize","tmpRow","i","j","_resetMatrix","v","varIndex","constraints","nConstraints","costRow","coeff","isMinimization","variable","index","rowIndex","t","term","constraint","constraintIndex","terms","nTerms","row","isUpperBound","coefficient","rhs","setModel","nVariables","unrestrictedVariables","getNewElementIndex","pop","density","r","setEvaluation","roundingCoeff","round","delta","p1","p2","x","deltaX","y","deltaY","Object","defineProperty","value","Δ","Δx","Δy","normX","abs","normY","norm","hypot","__importDefault","mod","__esModule","lodash_1","minX","node","default","minBy","maxX","maxBy","minY","maxY","setHeight","n","yMin","yMax","setWidth","xMin","xMax","setMinY","setMaxY","setMinX","setMaxX","diagonal","box","left","right","top","bottom","setTop","setBottom","setLeft","setRight","point_1","magnitude","vector","sum","v1","v2","diff","mult","k","Variable","id","IntegerVariable","call","SlackVariable","Term","createRelaxationVariable","weight","addVariable","relaxationIndex","Constraint","slack","termsByVarIndex","relaxation","Equality","constraintUpper","constraintLower","upperBound","lowerBound","isInteger","isSlack","addTerm","updateConstraintCoefficient","newCoefficient","setVariableCoefficient","removeTerm","setRightHandSide","newRhs","difference","updateRightHandSide","console","warn","relax","_relax","relaxationVariable","isEquality","box_1","overlap","n1","n2","padding","overlapX","overlapY","hasOverlap","nodes","lap","sorted","sortBy","forEach","edgeOverlap","map","edges","present","edge","source","target","getAllOverlaps","overlaps","tableau","_tableau","generateSolutionSet","solutionSet","lastRow","varValue","Cut","type","Branch","relaxedEvaluation","cuts","sortByEvaluation","applyCuts","branchingCuts","restore","addCutConstraints","useMIRCuts","fractionalVolumeImproved","fractionalVolumeBefore","computeFractionalVolume","applyMIRCuts","branches","iterations","bestEvaluation","Infinity","bestBranch","bestOptionalObjectivesEvaluations","oInit","branch","isCurrentEvaluationWorse","o","isIntegral","oCopy","save","getMostFractionalVar","cutsHigh","cutsLow","nCuts","cut","min","ceil","floor","cutHigh","cutLow","__export","m","p","hasOwnProperty","createFunction","f","vector_1","ROUND_PRECISION","number","multiplier","pow","toCartesian","cos","theta","sin","toPolar","rad","atan2","PI","angle","crop","graph","delaunator_1","overlap_1","delaunay","del","from","hastable","triangles","chunk","triangle","addable","augmented","edges1","edges2","_a","iterated","iteratee","added","e1","empty","e2","concat","merge","pair","optimalVector","desired","actual","widthRatio","heightRatio","unOverlapRatio","minimalVector","Δx_n1n2","Δy_n1n2","nodeMap","aggreg","createScale","initial","frame","scale","ratio","Model","expressions","validation","Numeral","Solver","lastSolvedModel","Solve","full","validate","test","Error","loadJson","solution","store","result","keys","d","ReformatLP","MultiObjective","define","window","solver","phase1","phase2","debugCheckForCycles","checkForCycles","varIndexesCycle","lastColumn","leavingRowIndex","rhsValue","enteringColumn","maxQuotient","leavingRow","quotient","cycleData","log","pivot","reducedCost","unrestricted","nOptionalObjectives","optionalCostsColumns","enteringValue","isReducedCostNegative","optionalCostsColumns2","minQuotient","colValue","nonZeroColumns","pivotRowIndex","pivotColumnIndex","leavingBasicIndex","enteringBasicIndex","v0","pivotRow","nNonZeroColumns","varIndexes","elt1","elt2","cycleFound","tmp1","tmp2","iter","create","constructor","cutConstraints","nCutConstraints","heightWithCuts","h","sign","varRowIndex","constraintRow","varRow","slackVarIndex","_addLowerBoundMIRCut","frac_d","colIndex","coef","termCoeff","_addUpperBoundMIRCut","aj","fj","_putInBase","r1","_takeOutOfBase","c1","slackColumn","colVar","rowVar","updateCost","varColumn","variableRow","addConstraint","slackIndex","removeConstraint","removeVariable","switchVarIndex","message","force","varName","varNameLength","valueSpace","nameSpace","rowString","varNameRowString","spacePerColumn","firstRow","firstRowString","toFixed","reducedCostsString","optionalObjectivesCopy","matrixCopy","savedMatrix","savedRow","savedBasicIndexes","savedNonBasicIndexes","savedRows","savedCols","optionalObjectivePerPriority","optionalObjectiveCopy","VariableData","biggestFraction","selectedVarIndex","selectedVarValue","integerVariables","nIntegerVars","fraction","getFractionalVarWithLowestCost","highestCost","countIntegerValues","count","decimalPart","ignoreIntegerValues","volume","name","tableauInitialized","minimize","maximize","_getNewElementIndex","_addConstraint","slackVariable","smallerThan","greaterThan","equal","isUnrestricted","_removeConstraint","idx","indexOf","splice","setCost","jsonModel","opType","constraintsMin","constraintsMax","constraintIds","nConstraintIds","constraintId","relaxed","equality","variableIds","integerVarIds","ints","binaryVarIds","binaries","unrestrictedVarIds","objectiveName","optimize","variableId","variableConstraints","isBinary","constraintNames","constraintName","constraintMin","constraintMax","isFeasible","activateMIRCuts","debug","CleanObjectiveAttributes","fakeAttr","z","random","input","rxo","tmp","ary","hldr","hldr2","split","is_objective","match","parse_lhs","replace","get_num","substr","parseFloat","get_word","_obj","is_int","parse_int","is_bin","parse_bin","is_constraint","separatorIndex","parse_rhs","parse_dir","is_unrestricted","to_JSON","output","lookup","rxClean","RegExp","from_JSON","objectives","new_constraints","JSON","parse","stringify","counter","vectors","vector_key","obj","pareto","cheater","midpoint","vertices","ranges","__assign","assign","s","arguments","apply","__rest","e","getOwnPropertySymbols","propertyIsEnumerable","agora_graph_1","javascript_lp_solver_1","node2Diamond","wii","SQRT2","diamondRotation","options","diamondGraphRotation","rotatedNodes","polar","cart","vs","hs","diamonds","findIndex","join","iIdx","_b","yi","wi","ymax","ymin","jIdx","_c","yj","wj","_d","lpsolve","tmodel","rest","positions","transform","val","key","tpe","rotatedPos","position"],"mappings":"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","file":"static/js/5.440c8cf3.chunk.js","sourcesContent":["/*global describe*/\n\n/*global require*/\n\n/*global module*/\n\n/*global it*/\n\n/*global console*/\n\n/*global process*/\nvar Solution = require(\"./Solution.js\");\n\nvar MilpSolution = require(\"./MilpSolution.js\");\n/*************************************************************\r\n * Class: Tableau\r\n * Description: Simplex tableau, holding a the tableau matrix\r\n *              and all the information necessary to perform\r\n *              the simplex algorithm\r\n * Agruments:\r\n *        precision: If we're solving a MILP, how tight\r\n *                   do we want to define an integer, given\r\n *                   that 20.000000000000001 is not an integer.\r\n *                   (defaults to 1e-8)\r\n **************************************************************/\n\n\nfunction Tableau(precision) {\n  this.model = null;\n  this.matrix = null;\n  this.width = 0;\n  this.height = 0;\n  this.costRowIndex = 0;\n  this.rhsColumn = 0;\n  this.variablesPerIndex = [];\n  this.unrestrictedVars = null; // Solution attributes\n\n  this.feasible = true; // until proven guilty\n\n  this.evaluation = 0;\n  this.varIndexByRow = null;\n  this.varIndexByCol = null;\n  this.rowByVarIndex = null;\n  this.colByVarIndex = null;\n  this.precision = precision || 1e-8;\n  this.optionalObjectives = [];\n  this.objectivesByPriority = {};\n  this.savedState = null;\n  this.availableIndexes = [];\n  this.lastElementIndex = 0;\n  this.variables = null;\n  this.nVars = 0;\n  this.bounded = true;\n  this.unboundedVarIndex = null;\n  this.branchAndCutIterations = 0;\n}\n\nmodule.exports = Tableau;\n\nTableau.prototype.solve = function () {\n  if (this.model.getNumberOfIntegerVariables() > 0) {\n    this.branchAndCut();\n  } else {\n    this.simplex();\n  }\n\n  this.updateVariableValues();\n  return this.getSolution();\n};\n\nfunction OptionalObjective(priority, nColumns) {\n  this.priority = priority;\n  this.reducedCosts = new Array(nColumns);\n\n  for (var c = 0; c < nColumns; c += 1) {\n    this.reducedCosts[c] = 0;\n  }\n}\n\nOptionalObjective.prototype.copy = function () {\n  var copy = new OptionalObjective(this.priority, this.reducedCosts.length);\n  copy.reducedCosts = this.reducedCosts.slice();\n  return copy;\n};\n\nTableau.prototype.setOptionalObjective = function (priority, column, cost) {\n  var objectiveForPriority = this.objectivesByPriority[priority];\n\n  if (objectiveForPriority === undefined) {\n    var nColumns = Math.max(this.width, column + 1);\n    objectiveForPriority = new OptionalObjective(priority, nColumns);\n    this.objectivesByPriority[priority] = objectiveForPriority;\n    this.optionalObjectives.push(objectiveForPriority);\n    this.optionalObjectives.sort(function (a, b) {\n      return a.priority - b.priority;\n    });\n  }\n\n  objectiveForPriority.reducedCosts[column] = cost;\n}; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nTableau.prototype.initialize = function (width, height, variables, unrestrictedVars) {\n  this.variables = variables;\n  this.unrestrictedVars = unrestrictedVars;\n  this.width = width;\n  this.height = height; // BUILD AN EMPTY ARRAY OF THAT WIDTH\n\n  var tmpRow = new Array(width);\n\n  for (var i = 0; i < width; i++) {\n    tmpRow[i] = 0;\n  } // BUILD AN EMPTY TABLEAU\n\n\n  this.matrix = new Array(height);\n\n  for (var j = 0; j < height; j++) {\n    this.matrix[j] = tmpRow.slice();\n  }\n\n  this.varIndexByRow = new Array(this.height);\n  this.varIndexByCol = new Array(this.width);\n  this.varIndexByRow[0] = -1;\n  this.varIndexByCol[0] = -1;\n  this.nVars = width + height - 2;\n  this.rowByVarIndex = new Array(this.nVars);\n  this.colByVarIndex = new Array(this.nVars);\n  this.lastElementIndex = this.nVars;\n};\n\nTableau.prototype._resetMatrix = function () {\n  var variables = this.model.variables;\n  var constraints = this.model.constraints;\n  var nVars = variables.length;\n  var nConstraints = constraints.length;\n  var v, varIndex;\n  var costRow = this.matrix[0];\n  var coeff = this.model.isMinimization === true ? -1 : 1;\n\n  for (v = 0; v < nVars; v += 1) {\n    var variable = variables[v];\n    var priority = variable.priority;\n    var cost = coeff * variable.cost;\n\n    if (priority === 0) {\n      costRow[v + 1] = cost;\n    } else {\n      this.setOptionalObjective(priority, v + 1, cost);\n    }\n\n    varIndex = variables[v].index;\n    this.rowByVarIndex[varIndex] = -1;\n    this.colByVarIndex[varIndex] = v + 1;\n    this.varIndexByCol[v + 1] = varIndex;\n  }\n\n  var rowIndex = 1;\n\n  for (var c = 0; c < nConstraints; c += 1) {\n    var constraint = constraints[c];\n    var constraintIndex = constraint.index;\n    this.rowByVarIndex[constraintIndex] = rowIndex;\n    this.colByVarIndex[constraintIndex] = -1;\n    this.varIndexByRow[rowIndex] = constraintIndex;\n    var t, term, column;\n    var terms = constraint.terms;\n    var nTerms = terms.length;\n    var row = this.matrix[rowIndex++];\n\n    if (constraint.isUpperBound) {\n      for (t = 0; t < nTerms; t += 1) {\n        term = terms[t];\n        column = this.colByVarIndex[term.variable.index];\n        row[column] = term.coefficient;\n      }\n\n      row[0] = constraint.rhs;\n    } else {\n      for (t = 0; t < nTerms; t += 1) {\n        term = terms[t];\n        column = this.colByVarIndex[term.variable.index];\n        row[column] = -term.coefficient;\n      }\n\n      row[0] = -constraint.rhs;\n    }\n  }\n}; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nTableau.prototype.setModel = function (model) {\n  this.model = model;\n  var width = model.nVariables + 1;\n  var height = model.nConstraints + 1;\n  this.initialize(width, height, model.variables, model.unrestrictedVariables);\n\n  this._resetMatrix();\n\n  return this;\n};\n\nTableau.prototype.getNewElementIndex = function () {\n  if (this.availableIndexes.length > 0) {\n    return this.availableIndexes.pop();\n  }\n\n  var index = this.lastElementIndex;\n  this.lastElementIndex += 1;\n  return index;\n};\n\nTableau.prototype.density = function () {\n  var density = 0;\n  var matrix = this.matrix;\n\n  for (var r = 0; r < this.height; r++) {\n    var row = matrix[r];\n\n    for (var c = 0; c < this.width; c++) {\n      if (row[c] !== 0) {\n        density += 1;\n      }\n    }\n  }\n\n  return density / (this.height * this.width);\n}; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nTableau.prototype.setEvaluation = function () {\n  // Rounding objective value\n  var roundingCoeff = Math.round(1 / this.precision);\n  var evaluation = this.matrix[this.costRowIndex][this.rhsColumn];\n  this.evaluation = Math.round(evaluation * roundingCoeff) / roundingCoeff;\n}; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nTableau.prototype.getSolution = function () {\n  var evaluation = this.model.isMinimization === true ? this.evaluation : -this.evaluation;\n\n  if (this.model.getNumberOfIntegerVariables() > 0) {\n    return new MilpSolution(this, evaluation, this.feasible, this.bounded, this.branchAndCutIterations);\n  } else {\n    return new Solution(this, evaluation, this.feasible, this.bounded);\n  }\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\r\n * @param {Point} p1 first point\r\n * @param {Point} p2 second point\r\n *\r\n * @returns creates a vector (p1, p2) using p1,p2\r\n */\n\nfunction delta(p1, p2) {\n  return {\n    x: deltaX(p1, p2),\n    y: deltaY(p1, p2)\n  };\n}\n\nexports.delta = delta;\nexports.Δ = delta;\n/**\r\n * @param {Point} p1\r\n * @param {Point} p2\r\n *\r\n * @returns {number} the Δ (x axis) between two points\r\n */\n\nfunction deltaX(p1, p2) {\n  return p2.x - p1.x;\n}\n\nexports.deltaX = deltaX;\nexports.Δx = deltaX;\n/**\r\n * @param {Point} p1\r\n * @param {Point} p2\r\n *\r\n * @returns {number} the Δ (y axis) between two points\r\n */\n\nfunction deltaY(p1, p2) {\n  return p2.y - p1.y;\n}\n\nexports.deltaY = deltaY;\nexports.Δy = deltaY;\n/**\r\n * @param {Point} p1\r\n * @param {Point} p2\r\n *\r\n * @returns {number} the norm (x axis) between two points\r\n */\n\nfunction normX(p1, p2) {\n  return Math.abs(deltaX(p1, p2));\n}\n\nexports.normX = normX;\n/**\r\n * @param {Point} p1\r\n * @param {Point} p2\r\n *\r\n * @returns {number} the norm (y axis) between two points\r\n */\n\nfunction normY(p1, p2) {\n  return Math.abs(deltaY(p1, p2));\n}\n\nexports.normY = normY;\n/**\r\n * @returns Distance between two points\r\n * @param p1\r\n * @param p2\r\n */\n\nfunction norm(p1, p2) {\n  return Math.hypot(deltaX(p1, p2), deltaY(p1, p2));\n}\n\nexports.norm = norm;","\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar lodash_1 = __importDefault(require(\"lodash\"));\n/**\r\n * diagonal length of the box\r\n * @param box\r\n */\n\n\nfunction diagonal(box) {\n  return Math.hypot(box.width, box.height);\n}\n\nexports.diagonal = diagonal;\n\nfunction minX(node) {\n  if (node instanceof Array) return lodash_1.default.minBy(node, function (v) {\n    return minX(v);\n  });\n  return node.x - node.width / 2;\n}\n\nexports.minX = minX;\nexports.left = minX;\n\nfunction maxX(node) {\n  if (node instanceof Array) return lodash_1.default.maxBy(node, function (v) {\n    return maxX(v);\n  });\n  return node.x + node.width / 2;\n}\n\nexports.maxX = maxX;\nexports.right = maxX;\n\nfunction minY(node) {\n  if (node instanceof Array) return lodash_1.default.minBy(node, function (v) {\n    return minY(v);\n  });\n  return node.y - node.height / 2;\n}\n\nexports.minY = minY;\nexports.top = minY;\n\nfunction maxY(node) {\n  if (node instanceof Array) return lodash_1.default.maxBy(node, function (v) {\n    return maxY(v);\n  });\n  return node.y + node.height / 2;\n}\n\nexports.maxY = maxY;\nexports.bottom = maxY;\n\nfunction setHeight(n, yMin, yMax) {\n  n.height = yMax - yMin;\n  return n;\n}\n\nexports.setHeight = setHeight;\n\nfunction setWidth(n, xMin, xMax) {\n  n.width = xMax - xMin;\n  return n;\n}\n\nexports.setWidth = setWidth;\n\nfunction setMinY(n, yMin) {\n  setHeight(n, yMin, maxY(n));\n  n.y = n.height / 2 + yMin;\n  return n;\n}\n\nexports.setMinY = setMinY;\nexports.setTop = setMinY;\n\nfunction setMaxY(n, yMax) {\n  var yMin = minY(n);\n  setHeight(n, yMin, yMax);\n  n.y = n.height / 2 + yMin;\n  return n;\n}\n\nexports.setMaxY = setMaxY;\nexports.setBottom = setMaxY;\n\nfunction setMinX(n, xMin) {\n  setWidth(n, xMin, maxX(n));\n  n.x = n.width / 2 + xMin;\n  return n;\n}\n\nexports.setMinX = setMinX;\nexports.setLeft = setMinX;\n\nfunction setMaxX(n, xMax) {\n  var xMin = minX(n);\n  setWidth(n, xMin, xMax);\n  n.x = n.width / 2 + xMin;\n  return n;\n}\n\nexports.setMaxX = setMaxX;\nexports.setRight = setMaxX;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar point_1 = require(\"./point\");\n\nexports.vector = point_1.delta;\n/**\r\n * length of the vector\r\n * @param vector\r\n */\n\nfunction magnitude(vector) {\n  return Math.hypot(vector.x, vector.y);\n}\n\nexports.magnitude = magnitude;\nexports.length = magnitude;\n/**\r\n * Sums two vectors\r\n * @param v1\r\n * @param v2\r\n */\n\nfunction sum(v1, v2) {\n  return {\n    x: v1.x + v2.x,\n    y: v1.y + v2.y\n  };\n}\n\nexports.sum = sum;\n/**\r\n * substract vector v1 - v2\r\n * @param v1\r\n * @param v2\r\n */\n\nfunction diff(v1, v2) {\n  return {\n    x: v1.x - v2.x,\n    y: v1.y - v2.y\n  };\n}\n\nexports.diff = diff;\n/**\r\n * Scalar multiplication (mutable)\r\n *\r\n * @param v\r\n * @param k\r\n */\n\nfunction mult(v, k) {\n  v.x *= k;\n  v.y *= k;\n  return v;\n}\n\nexports.mult = mult;","/*global describe*/\n\n/*global require*/\n\n/*global module*/\n\n/*global it*/\n\n/*global console*/\n\n/*global process*/\n//-------------------------------------------------------------------\n//-------------------------------------------------------------------\nfunction Variable(id, cost, index, priority) {\n  this.id = id;\n  this.cost = cost;\n  this.index = index;\n  this.value = 0;\n  this.priority = priority;\n}\n\nfunction IntegerVariable(id, cost, index, priority) {\n  Variable.call(this, id, cost, index, priority);\n}\n\nIntegerVariable.prototype.isInteger = true;\n\nfunction SlackVariable(id, index) {\n  Variable.call(this, id, 0, index, 0);\n}\n\nSlackVariable.prototype.isSlack = true; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\nfunction Term(variable, coefficient) {\n  this.variable = variable;\n  this.coefficient = coefficient;\n}\n\nfunction createRelaxationVariable(model, weight, priority) {\n  if (priority === 0 || priority === \"required\") {\n    return null;\n  }\n\n  weight = weight || 1;\n  priority = priority || 1;\n\n  if (model.isMinimization === false) {\n    weight = -weight;\n  }\n\n  return model.addVariable(weight, \"r\" + model.relaxationIndex++, false, false, priority);\n} //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nfunction Constraint(rhs, isUpperBound, index, model) {\n  this.slack = new SlackVariable(\"s\" + index, index);\n  this.index = index;\n  this.model = model;\n  this.rhs = rhs;\n  this.isUpperBound = isUpperBound;\n  this.terms = [];\n  this.termsByVarIndex = {}; // Error variable in case the constraint is relaxed\n\n  this.relaxation = null;\n}\n\nConstraint.prototype.addTerm = function (coefficient, variable) {\n  var varIndex = variable.index;\n  var term = this.termsByVarIndex[varIndex];\n\n  if (term === undefined) {\n    // No term for given variable\n    term = new Term(variable, coefficient);\n    this.termsByVarIndex[varIndex] = term;\n    this.terms.push(term);\n\n    if (this.isUpperBound === true) {\n      coefficient = -coefficient;\n    }\n\n    this.model.updateConstraintCoefficient(this, variable, coefficient);\n  } else {\n    // Term for given variable already exists\n    // updating its coefficient\n    var newCoefficient = term.coefficient + coefficient;\n    this.setVariableCoefficient(newCoefficient, variable);\n  }\n\n  return this;\n};\n\nConstraint.prototype.removeTerm = function (term) {\n  // TODO\n  return this;\n};\n\nConstraint.prototype.setRightHandSide = function (newRhs) {\n  if (newRhs !== this.rhs) {\n    var difference = newRhs - this.rhs;\n\n    if (this.isUpperBound === true) {\n      difference = -difference;\n    }\n\n    this.rhs = newRhs;\n    this.model.updateRightHandSide(this, difference);\n  }\n\n  return this;\n};\n\nConstraint.prototype.setVariableCoefficient = function (newCoefficient, variable) {\n  var varIndex = variable.index;\n\n  if (varIndex === -1) {\n    console.warn(\"[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.\");\n    return;\n  }\n\n  var term = this.termsByVarIndex[varIndex];\n\n  if (term === undefined) {\n    // No term for given variable\n    this.addTerm(newCoefficient, variable);\n  } else {\n    // Term for given variable already exists\n    // updating its coefficient if changed\n    if (newCoefficient !== term.coefficient) {\n      var difference = newCoefficient - term.coefficient;\n\n      if (this.isUpperBound === true) {\n        difference = -difference;\n      }\n\n      term.coefficient = newCoefficient;\n      this.model.updateConstraintCoefficient(this, variable, difference);\n    }\n  }\n\n  return this;\n};\n\nConstraint.prototype.relax = function (weight, priority) {\n  this.relaxation = createRelaxationVariable(this.model, weight, priority);\n\n  this._relax(this.relaxation);\n};\n\nConstraint.prototype._relax = function (relaxationVariable) {\n  if (relaxationVariable === null) {\n    // Relaxation variable not created, priority was probably \"required\"\n    return;\n  }\n\n  if (this.isUpperBound) {\n    this.setVariableCoefficient(-1, relaxationVariable);\n  } else {\n    this.setVariableCoefficient(1, relaxationVariable);\n  }\n}; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nfunction Equality(constraintUpper, constraintLower) {\n  this.upperBound = constraintUpper;\n  this.lowerBound = constraintLower;\n  this.model = constraintUpper.model;\n  this.rhs = constraintUpper.rhs;\n  this.relaxation = null;\n}\n\nEquality.prototype.isEquality = true;\n\nEquality.prototype.addTerm = function (coefficient, variable) {\n  this.upperBound.addTerm(coefficient, variable);\n  this.lowerBound.addTerm(coefficient, variable);\n  return this;\n};\n\nEquality.prototype.removeTerm = function (term) {\n  this.upperBound.removeTerm(term);\n  this.lowerBound.removeTerm(term);\n  return this;\n};\n\nEquality.prototype.setRightHandSide = function (rhs) {\n  this.upperBound.setRightHandSide(rhs);\n  this.lowerBound.setRightHandSide(rhs);\n  this.rhs = rhs;\n};\n\nEquality.prototype.relax = function (weight, priority) {\n  this.relaxation = createRelaxationVariable(this.model, weight, priority);\n  this.upperBound.relaxation = this.relaxation;\n\n  this.upperBound._relax(this.relaxation);\n\n  this.lowerBound.relaxation = this.relaxation;\n\n  this.lowerBound._relax(this.relaxation);\n};\n\nmodule.exports = {\n  Constraint: Constraint,\n  Variable: Variable,\n  IntegerVariable: IntegerVariable,\n  SlackVariable: SlackVariable,\n  Equality: Equality,\n  Term: Term\n};","\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar lodash_1 = __importDefault(require(\"lodash\"));\n\nvar box_1 = require(\"./box\");\n\nvar point_1 = require(\"./point\");\n/**\r\n * @param n1\r\n * @param n2\r\n * @param padding\r\n *\r\n * @returns true if the nodes overlap\r\n */\n\n\nfunction overlap(n1, n2, padding) {\n  if (padding === void 0) {\n    padding = 0;\n  }\n\n  return overlapX(n1, n2, padding) && overlapY(n1, n2, padding);\n}\n\nexports.overlap = overlap;\n/**\r\n * @param n1\r\n * @param n2\r\n * @param padding\r\n *\r\n * @returns true if the nodes overlap on x\r\n */\n\nfunction overlapX(n1, n2, padding) {\n  if (padding === void 0) {\n    padding = 0;\n  }\n\n  return point_1.normX(n1, n2) < (n1.width + n2.width) / 2 + +padding;\n}\n\nexports.overlapX = overlapX;\n/**\r\n * @param n1\r\n * @param n2\r\n * @param padding\r\n *\r\n * @returns true if the nodes overlap on y\r\n */\n\nfunction overlapY(n1, n2, padding) {\n  if (padding === void 0) {\n    padding = 0;\n  }\n\n  return point_1.normY(n1, n2) < (n1.height + n2.height) / 2 + +padding;\n}\n\nexports.overlapY = overlapY;\n/**\r\n * @param nodes\r\n * @param padding\r\n * @returns true if at least two nodes of the list overlap\r\n */\n\nfunction hasOverlap(nodes, padding) {\n  if (padding === void 0) {\n    padding = 0;\n  }\n\n  var lap = false;\n  var sorted = lodash_1.default.sortBy(nodes, function (node) {\n    return box_1.left(node);\n  });\n  lodash_1.default.forEach(sorted, function (n1, index) {\n    for (var j = index + 1; j < nodes.length; j++) {\n      var n2 = sorted[j];\n\n      if (overlap(n1, n2, padding)) {\n        lap = true;\n        return false; // exit _.forEach\n      } else if (box_1.left(n2) > box_1.right(n1) + padding) break;\n    }\n  });\n  return lap;\n}\n\nexports.hasOverlap = hasOverlap;\n/**\r\n * Get all the overlaps between couple of nodes\r\n * @param map map of nodes having their index as keys\r\n * @param edges\r\n * @param padding\r\n */\n\nfunction edgeOverlap(map, edges, padding) {\n  if (padding === void 0) {\n    padding = 0;\n  }\n\n  var present = false;\n  lodash_1.default.forEach(edges, function (edge) {\n    if (overlap(map[edge.source], map[edge.target], padding)) {\n      present = true;\n      return false;\n    }\n  });\n  return present;\n}\n\nexports.edgeOverlap = edgeOverlap;\n/**\r\n * @param {Node[]} nodes\r\n * @param {number} [padding]\r\n *\r\n * @returns the list of all overlaps of the graph.\r\n */\n\nfunction getAllOverlaps(nodes, padding) {\n  if (padding === void 0) {\n    padding = 0;\n  }\n\n  var sorted = lodash_1.default.sortBy(nodes, function (node) {\n    return box_1.left(node);\n  });\n  var overlaps = [];\n  lodash_1.default.forEach(sorted, function (n1, index) {\n    for (var j = index + 1; j < nodes.length; j++) {\n      var n2 = sorted[j];\n      if (overlap(n1, n2, padding)) overlaps.push([n1, n2]);else if (box_1.left(n2) > box_1.right(n1) + padding) break;\n    }\n  });\n  return overlaps;\n}\n\nexports.getAllOverlaps = getAllOverlaps;","/*global module*/\nfunction Solution(tableau, evaluation, feasible, bounded) {\n  this.feasible = feasible;\n  this.evaluation = evaluation;\n  this.bounded = bounded;\n  this._tableau = tableau;\n}\n\nmodule.exports = Solution;\n\nSolution.prototype.generateSolutionSet = function () {\n  var solutionSet = {};\n  var tableau = this._tableau;\n  var varIndexByRow = tableau.varIndexByRow;\n  var variablesPerIndex = tableau.variablesPerIndex;\n  var matrix = tableau.matrix;\n  var rhsColumn = tableau.rhsColumn;\n  var lastRow = tableau.height - 1;\n  var roundingCoeff = Math.round(1 / tableau.precision);\n\n  for (var r = 1; r <= lastRow; r += 1) {\n    var varIndex = varIndexByRow[r];\n    var variable = variablesPerIndex[varIndex];\n\n    if (variable === undefined || variable.isSlack === true) {\n      continue;\n    }\n\n    var varValue = matrix[r][rhsColumn];\n    solutionSet[variable.id] = Math.round(varValue * roundingCoeff) / roundingCoeff;\n  }\n\n  return solutionSet;\n};","/*global describe*/\n\n/*global require*/\n\n/*global module*/\n\n/*global it*/\n\n/*global console*/\n\n/*global process*/\nvar Tableau = require(\"./Tableau.js\"); //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nfunction Cut(type, varIndex, value) {\n  this.type = type;\n  this.varIndex = varIndex;\n  this.value = value;\n} //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nfunction Branch(relaxedEvaluation, cuts) {\n  this.relaxedEvaluation = relaxedEvaluation;\n  this.cuts = cuts;\n} //-------------------------------------------------------------------\n// Branch sorting strategies\n//-------------------------------------------------------------------\n\n\nfunction sortByEvaluation(a, b) {\n  return b.relaxedEvaluation - a.relaxedEvaluation;\n} //-------------------------------------------------------------------\n// Applying cuts on a tableau and resolving\n//-------------------------------------------------------------------\n\n\nTableau.prototype.applyCuts = function (branchingCuts) {\n  // Restoring initial solution\n  this.restore();\n  this.addCutConstraints(branchingCuts);\n  this.simplex(); // Adding MIR cuts\n\n  if (this.model.useMIRCuts) {\n    var fractionalVolumeImproved = true;\n\n    while (fractionalVolumeImproved) {\n      var fractionalVolumeBefore = this.computeFractionalVolume(true);\n      this.applyMIRCuts();\n      this.simplex();\n      var fractionalVolumeAfter = this.computeFractionalVolume(true); // If the new fractional volume is bigger than 90% of the previous one\n      // we assume there is no improvement from the MIR cuts\n\n      if (fractionalVolumeAfter >= 0.9 * fractionalVolumeBefore) {\n        fractionalVolumeImproved = false;\n      }\n    }\n  }\n}; //-------------------------------------------------------------------\n// Function: MILP\n// Detail: Main function, my attempt at a mixed integer linear programming\n//         solver\n//-------------------------------------------------------------------\n\n\nTableau.prototype.branchAndCut = function () {\n  var branches = [];\n  var iterations = 0; // This is the default result\n  // If nothing is both *integral* and *feasible*\n\n  var bestEvaluation = Infinity;\n  var bestBranch = null;\n  var bestOptionalObjectivesEvaluations = [];\n\n  for (var oInit = 0; oInit < this.optionalObjectives.length; oInit += 1) {\n    bestOptionalObjectivesEvaluations.push(Infinity);\n  } // And here...we...go!\n  // 1.) Load a model into the queue\n\n\n  var branch = new Branch(-Infinity, []);\n  branches.push(branch); // If all branches have been exhausted terminate the loop\n\n  while (branches.length > 0) {\n    // Get a model from the queue\n    branch = branches.pop();\n\n    if (branch.relaxedEvaluation > bestEvaluation) {\n      continue;\n    } // Solving from initial relaxed solution\n    // with additional cut constraints\n    // Adding cut constraints\n\n\n    var cuts = branch.cuts;\n    this.applyCuts(cuts);\n    iterations++;\n\n    if (this.feasible === false) {\n      continue;\n    }\n\n    var evaluation = this.evaluation;\n\n    if (evaluation > bestEvaluation) {\n      // This branch does not contain the optimal solution\n      continue;\n    } // To deal with the optional objectives\n\n\n    if (evaluation === bestEvaluation) {\n      var isCurrentEvaluationWorse = true;\n\n      for (var o = 0; o < this.optionalObjectives.length; o += 1) {\n        if (this.optionalObjectives[o].reducedCosts[0] > bestOptionalObjectivesEvaluations[o]) {\n          break;\n        } else if (this.optionalObjectives[o].reducedCosts[0] < bestOptionalObjectivesEvaluations[o]) {\n          isCurrentEvaluationWorse = false;\n          break;\n        }\n      }\n\n      if (isCurrentEvaluationWorse) {\n        continue;\n      }\n    } // Is the model both integral and feasible?\n\n\n    if (this.isIntegral() === true) {\n      if (iterations === 1) {\n        this.branchAndCutIterations = iterations;\n        return;\n      } // Store the solution as the bestSolution\n\n\n      bestBranch = branch;\n      bestEvaluation = evaluation;\n\n      for (var oCopy = 0; oCopy < this.optionalObjectives.length; oCopy += 1) {\n        bestOptionalObjectivesEvaluations[oCopy] = this.optionalObjectives[oCopy].reducedCosts[0];\n      }\n    } else {\n      if (iterations === 1) {\n        // Saving the first iteration\n        // TODO: implement a better strategy for saving the tableau?\n        this.save();\n      } // If the solution is\n      //  a. Feasible\n      //  b. Better than the current solution\n      //  c. but *NOT* integral\n      // So the solution isn't integral? How do we solve this.\n      // We create 2 new models, that are mirror images of the prior\n      // model, with 1 exception.\n      // Say we're trying to solve some stupid problem requiring you get\n      // animals for your daughter's kindergarten petting zoo party\n      // and you have to choose how many ducks, goats, and lambs to get.\n      // Say that the optimal solution to this problem if we didn't have\n      // to make it integral was {duck: 8, lambs: 3.5}\n      //\n      // To keep from traumatizing your daughter and the other children\n      // you're going to want to have whole animals\n      // What we would do is find the most fractional variable (lambs)\n      // and create new models from the old models, but with a new constraint\n      // on apples. The constraints on the low model would look like:\n      // constraints: {...\n      //   lamb: {max: 3}\n      //   ...\n      // }\n      //\n      // while the constraints on the high model would look like:\n      //\n      // constraints: {...\n      //   lamb: {min: 4}\n      //   ...\n      // }\n      // If neither of these models is feasible because of this constraint,\n      // the model is not integral at this point, and fails.\n      // Find out where we want to split the solution\n\n\n      var variable = this.getMostFractionalVar();\n      var varIndex = variable.index;\n      var cutsHigh = [];\n      var cutsLow = [];\n      var nCuts = cuts.length;\n\n      for (var c = 0; c < nCuts; c += 1) {\n        var cut = cuts[c];\n\n        if (cut.varIndex === varIndex) {\n          if (cut.type === \"min\") {\n            cutsLow.push(cut);\n          } else {\n            cutsHigh.push(cut);\n          }\n        } else {\n          cutsHigh.push(cut);\n          cutsLow.push(cut);\n        }\n      }\n\n      var min = Math.ceil(variable.value);\n      var max = Math.floor(variable.value);\n      var cutHigh = new Cut(\"min\", varIndex, min);\n      cutsHigh.push(cutHigh);\n      var cutLow = new Cut(\"max\", varIndex, max);\n      cutsLow.push(cutLow);\n      branches.push(new Branch(evaluation, cutsHigh));\n      branches.push(new Branch(evaluation, cutsLow)); // Sorting branches\n      // Branches with the most promising lower bounds\n      // will be picked first\n\n      branches.sort(sortByEvaluation);\n    }\n  } // Adding cut constraints for the optimal solution\n\n\n  if (bestBranch !== null) {\n    // The model is feasible\n    this.applyCuts(bestBranch.cuts);\n  }\n\n  this.branchAndCutIterations = iterations;\n};","\"use strict\";\n\nfunction __export(m) {\n  for (var p in m) {\n    if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n  }\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n__export(require(\"./algorithm\"));\n\n__export(require(\"./box\"));\n\n__export(require(\"./conversion\"));\n\n__export(require(\"./cropped\"));\n\n__export(require(\"./delaunay-edges\"));\n\n__export(require(\"./distance\"));\n\n__export(require(\"./node-map\"));\n\n__export(require(\"./overlap\"));\n\n__export(require(\"./point\"));\n\n__export(require(\"./scale\"));\n\n__export(require(\"./vector\"));","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction createFunction(f) {\n  return f;\n}\n\nexports.createFunction = createFunction;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar vector_1 = require(\"./vector\");\n\nvar ROUND_PRECISION = -14;\n\nfunction toCartesian(vector, precision) {\n  if (precision === void 0) {\n    precision = ROUND_PRECISION;\n  }\n\n  return {\n    x: round(vector.length * Math.cos(vector.theta), precision),\n    y: round(vector.length * Math.sin(vector.theta), precision)\n  };\n}\n\nexports.toCartesian = toCartesian;\n\nfunction toPolar(vector, precision) {\n  if (precision === void 0) {\n    precision = ROUND_PRECISION;\n  }\n\n  var rad = Math.atan2(vector.y, vector.x);\n\n  if (rad < 0) {\n    rad = rad + 2 * Math.PI;\n  }\n\n  return {\n    length: vector_1.length(vector),\n    theta: rad,\n    angle: round(rad * 180 / Math.PI, precision)\n  };\n}\n\nexports.toPolar = toPolar;\n\nfunction round(number, precision) {\n  if (precision === void 0) {\n    precision = 0;\n  }\n\n  var multiplier = Math.pow(10, -precision);\n  return Math.round(number * multiplier) / multiplier;\n}\n\nexports.round = round;","\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar lodash_1 = __importDefault(require(\"lodash\"));\n\nvar box_1 = require(\"./box\");\n\nfunction crop(graph) {\n  var minX = box_1.left(box_1.left(graph.nodes));\n  var minY = box_1.top(box_1.top(graph.nodes));\n  lodash_1.default.forEach(graph.nodes, function (n) {\n    n.x -= minX;\n    n.y -= minY;\n  });\n  return graph;\n}\n\nexports.crop = crop;","\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar delaunator_1 = __importDefault(require(\"delaunator\"));\n\nvar lodash_1 = __importDefault(require(\"lodash\"));\n\nvar overlap_1 = require(\"./overlap\");\n\nexports.default = delaunay;\n\nfunction delaunay(nodes) {\n  var del = delaunator_1.default.from(nodes, function (node) {\n    return node.x;\n  }, function (node) {\n    return node.y;\n  });\n  var hastable = [];\n  var triangles = lodash_1.default.chunk(del.triangles, 3); // create edges\n\n  var edges = [];\n  lodash_1.default.forEach(triangles, function (triangle) {\n    triangle.sort(function (a, b) {\n      return +a - +b;\n    });\n    var a = +triangle[0],\n        b = +triangle[1],\n        c = +triangle[2];\n    if (addable(hastable, a, b)) edges.push({\n      source: nodes[a].index,\n      target: nodes[b].index\n    });\n    if (addable(hastable, b, c)) edges.push({\n      source: nodes[b].index,\n      target: nodes[c].index\n    });\n    if (addable(hastable, a, c)) edges.push({\n      source: nodes[a].index,\n      target: nodes[c].index\n    });\n  });\n  return lodash_1.default.sortBy(edges, ['source', 'target']);\n}\n\nexports.delaunay = delaunay;\n\nfunction addable(hastable, i, j) {\n  if (hastable[i] === void 0 || hastable[i][j] !== true) {\n    if (!hastable[i]) hastable[i] = [];\n    hastable[i][j] = true;\n    return true;\n  }\n\n  return false;\n}\n/**\r\n * augment the delaunay triangulation with the overlaping nodes\r\n * @param nodes list of nodes\r\n * @param padding padding between nodes\r\n */\n\n\nfunction augmented(nodes, padding) {\n  return merge(delaunay(nodes), overlaps(nodes, padding));\n}\n\nexports.augmented = augmented;\n/**\r\n * Get all overlaps of the list of nodes\r\n * @param nodes\r\n * @param padding\r\n */\n\nfunction overlaps(nodes, padding) {\n  return lodash_1.default(overlap_1.getAllOverlaps(nodes, padding)).map(function (pair) {\n    pair.sort(function (a, b) {\n      return a.index - b.index;\n    });\n    return {\n      source: pair[0].index,\n      target: pair[1].index\n    };\n  }).sortBy(['source', 'target']).value();\n}\n/**\r\n * Merging multiple edge list while removing redundancy\r\n * @param edges1\r\n * @param edges2\r\n */\n\n\nfunction merge(edges1, edges2) {\n  var _a = edges1.length <= edges2.length ? [edges1, edges2] : [edges2, edges1],\n      iterated = _a[0],\n      iteratee = _a[1];\n\n  var added = [];\n  lodash_1.default.forEach(iterated, function (e1) {\n    var empty = true;\n    lodash_1.default.forEach(iteratee, function (e2) {\n      if (e1.source === e2.source && e1.target === e2.target) {\n        empty = false;\n        return false;\n      }\n\n      if (e1.source === e2.source && e1.target < e2.target || e1.source < e2.source) {\n        added.push(e1);\n        empty = false;\n        return false;\n      }\n    });\n    if (empty) added.push(e1);\n  });\n  return lodash_1.default.concat(added, iteratee);\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar point_1 = require(\"./point\");\n\nvar vector_1 = require(\"./vector\");\n/**\r\n * @param n1\r\n * @param n2\r\n * @param padding\r\n *\r\n * @returns the closest position of n2 relative to n1 while avoiding overlapping, along the (n1,n2) line.\r\n */\n\n\nfunction optimalVector(n1, n2, padding) {\n  if (padding === void 0) {\n    padding = 0;\n  } // optimal distance for each axis\n\n\n  var desired = {\n    x: +(n1.width + n2.width) / 2 + +padding,\n    y: +(n1.height + n2.height) / 2 + +padding\n  }; // distances\n\n  var actual = point_1.Δ(n1, n2);\n\n  if (actual.x === 0 && actual.y === 0) {\n    return {\n      x: 0,\n      y: 0\n    };\n  } // ratios\n\n\n  var widthRatio = desired.x / actual.x,\n      heightRatio = desired.y / actual.y;\n  var unOverlapRatio = Math.min(Math.abs(widthRatio), Math.abs(heightRatio));\n  return vector_1.mult(actual, unOverlapRatio);\n}\n\nexports.optimalVector = optimalVector;\n/**\r\n *\r\n * @param n1\r\n * @param n2\r\n * @param padding\r\n *\r\n * @returns the minimal vector between two nodes ; the closest position of n2 relative to n1 according his current position, while avoiding overlapping\r\n */\n\nfunction minimalVector(n1, n2, padding) {\n  if (padding === void 0) {\n    padding = 0;\n  }\n\n  var Δx_n1n2 = point_1.Δx(n1, n2);\n  var Δy_n1n2 = point_1.Δy(n1, n2);\n\n  if (Δx_n1n2 <= Δy_n1n2) {\n    return {\n      x: Δx_n1n2 + 2 * padding,\n      y: 0\n    };\n  } else {\n    return {\n      x: 0,\n      y: Δy_n1n2 + 2 * padding\n    };\n  }\n}\n\nexports.minimalVector = minimalVector;","\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar lodash_1 = __importDefault(require(\"lodash\"));\n\nfunction nodeMap(nodes) {\n  var aggreg = {};\n  lodash_1.default.forEach(nodes, function (node) {\n    aggreg[node.index] = node;\n  });\n  return aggreg;\n}\n\nexports.nodeMap = nodeMap;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\r\n *\r\n * @param initial\r\n * @param frame\r\n *\r\n * @returns function which converts the coordinate for the projection\r\n */\n\nfunction createScale(initial, frame) {\n  var scale = function scale(initial) {\n    return scale.ratio * initial;\n  };\n\n  scale.ratio = Math.min(frame.width / initial.width, frame.height / initial.height);\n  return scale;\n}\n\nexports.createScale = createScale;","/*global describe*/\n\n/*global require*/\n\n/*global module*/\n\n/*global it*/\n\n/*global console*/\n\n/*global process*/\n//-------------------------------------------------------------------\n// SimplexJS\n// https://github.com/\n// An Object-Oriented Linear Programming Solver\n//\n// By Justin Wolcott (c)\n// Licensed under the MIT License.\n//-------------------------------------------------------------------\nvar Tableau = require(\"./Tableau/index.js\");\n\nvar Model = require(\"./Model\");\n\nvar branchAndCut = require(\"./Tableau/branchAndCut\");\n\nvar expressions = require(\"./expressions.js\");\n\nvar validation = require(\"./Validation\");\n\nvar Constraint = expressions.Constraint;\nvar Variable = expressions.Variable;\nvar Numeral = expressions.Numeral;\nvar Term = expressions.Term; // Place everything under the Solver Name Space\n\nvar Solver = function Solver() {\n  \"use strict\";\n\n  this.Model = Model;\n  this.branchAndCut = branchAndCut;\n  this.Constraint = Constraint;\n  this.Variable = Variable;\n  this.Numeral = Numeral;\n  this.Term = Term;\n  this.Tableau = Tableau;\n  this.lastSolvedModel = null;\n  /*************************************************************\r\n   * Method: Solve\r\n   * Scope: Public:\r\n   * Agruments:\r\n   *        model: The model we want solver to operate on\r\n   *        precision: If we're solving a MILP, how tight\r\n   *                   do we want to define an integer, given\r\n   *                   that 20.000000000000001 is not an integer.\r\n   *                   (defaults to 1e-9)\r\n   *            full: *get better description*\r\n   *        validate: if left blank, it will get ignored; otherwise\r\n   *                  it will run the model through all validation\r\n   *                  functions in the *Validate* module\r\n   **************************************************************/\n\n  this.Solve = function (model, precision, full, validate) {\n    // Run our validations on the model\n    // if the model doesn't have a validate\n    // attribute set to false\n    if (validate) {\n      for (var test in validation) {\n        model = validation[test](model);\n      }\n    } // Make sure we at least have a model\n\n\n    if (!model) {\n      throw new Error(\"Solver requires a model to operate on\");\n    }\n\n    if (model instanceof Model === false) {\n      model = new Model(precision).loadJson(model);\n    }\n\n    var solution = model.solve();\n    this.lastSolvedModel = model;\n    solution.solutionSet = solution.generateSolutionSet(); // If the user asks for a full breakdown\n    // of the tableau (e.g. full === true)\n    // this will return it\n\n    if (full) {\n      return solution;\n    } else {\n      // Otherwise; give the user the bare\n      // minimum of info necessary to carry on\n      var store = {}; // 1.) Add in feasibility to store;\n\n      store.feasible = solution.feasible; // 2.) Add in the objective value\n\n      store.result = solution.evaluation;\n      store.bounded = solution.bounded; // 3.) Load all of the variable values\n\n      Object.keys(solution.solutionSet).map(function (d) {\n        store[d] = solution.solutionSet[d];\n      });\n      return store;\n    }\n  };\n  /*************************************************************\r\n   * Method: ReformatLP\r\n   * Scope: Public:\r\n   * Agruments: model: The model we want solver to operate on\r\n   * Purpose: Convert a friendly JSON model into a model for a\r\n   *          real solving library...in this case\r\n   *          lp_solver\r\n   **************************************************************/\n\n\n  this.ReformatLP = require(\"./Reformat\");\n  /*************************************************************\r\n  * Method: MultiObjective\r\n  * Scope: Public:\r\n  * Agruments:\r\n  *        model: The model we want solver to operate on\r\n  *        detail: if false, or undefined; it will return the\r\n  *                result of using the mid-point formula; otherwise\r\n  *                it will return an object containing:\r\n  *\r\n  *                1. The results from the mid point formula\r\n  *                2. The solution for each objective solved\r\n  *                   in isolation (pareto)\r\n  *                3. The min and max of each variable along\r\n  *                   the frontier of the polytope (ranges)\r\n  * Purpose: Solve a model with multiple objective functions.\r\n  *          Since a potential infinite number of solutions exist\r\n  *          this naively returns the mid-point between\r\n  *\r\n  * Note: The model has to be changed a little to work with this.\r\n  *       Before an *opType* was required. No more. The objective\r\n  *       attribute of the model is now an object instead of a\r\n  *       string.\r\n  *\r\n  *  *EXAMPLE MODEL*\r\n  *\r\n  *   model = {\r\n  *       optimize: {scotch: \"max\", soda: \"max\"},\r\n  *       constraints: {fluid: {equal: 100}},\r\n  *       variables: {\r\n  *           scotch: {fluid: 1, scotch: 1},\r\n  *           soda: {fluid: 1, soda: 1}\r\n  *       }\r\n  *   }\r\n  *\r\n  **************************************************************/\n\n  this.MultiObjective = function (model) {\n    return require(\"./Polyopt\")(this, model);\n  };\n};\n\nvar define = define || undefined;\nvar window = window || undefined; // If the project is loading through require.js, use `define` and exit\n\nif (typeof define === \"function\") {\n  define([], function () {\n    return new Solver();\n  }); // If the project doesn't see define, but sees window, put solver on window\n} else if (typeof window === \"object\") {\n  window.solver = new Solver();\n} // Ensure that its available in node.js env\n\n\nmodule.exports = new Solver();","/*global require*/\n\n/*global module*/\nrequire(\"./simplex.js\");\n\nrequire(\"./cuttingStrategies.js\");\n\nrequire(\"./dynamicModification.js\");\n\nrequire(\"./log.js\");\n\nrequire(\"./backup.js\");\n\nrequire(\"./branchingStrategies.js\");\n\nrequire(\"./integerProperties.js\");\n\nmodule.exports = require(\"./Tableau.js\");","/*global describe*/\n\n/*global require*/\n\n/*global module*/\n\n/*global it*/\n\n/*global console*/\n\n/*global process*/\nvar Tableau = require(\"./Tableau.js\"); //-------------------------------------------------------------------\n// Function: solve\n// Detail: Main function, linear programming solver\n//-------------------------------------------------------------------\n\n\nTableau.prototype.simplex = function () {\n  // Bounded until proven otherwise\n  this.bounded = true; // Execute Phase 1 to obtain a Basic Feasible Solution (BFS)\n\n  this.phase1(); // Execute Phase 2\n\n  if (this.feasible === true) {\n    // Running simplex on Initial Basic Feasible Solution (BFS)\n    // N.B current solution is feasible\n    this.phase2();\n  }\n\n  return this;\n}; //-------------------------------------------------------------------\n// Description: Convert a non standard form tableau\n//              to a standard form tableau by eliminating\n//              all negative values in the Right Hand Side (RHS)\n//              This results in a Basic Feasible Solution (BFS)\n//\n//-------------------------------------------------------------------\n\n\nTableau.prototype.phase1 = function () {\n  var debugCheckForCycles = this.model.checkForCycles;\n  var varIndexesCycle = [];\n  var matrix = this.matrix;\n  var rhsColumn = this.rhsColumn;\n  var lastColumn = this.width - 1;\n  var lastRow = this.height - 1;\n  var unrestricted;\n  var iterations = 0;\n\n  while (true) {\n    // Selecting leaving variable (feasibility condition):\n    // Basic variable with most negative value\n    var leavingRowIndex = 0;\n    var rhsValue = -this.precision;\n\n    for (var r = 1; r <= lastRow; r++) {\n      unrestricted = this.unrestrictedVars[this.varIndexByRow[r]] === true;\n\n      if (unrestricted) {\n        continue;\n      }\n\n      var value = matrix[r][rhsColumn];\n\n      if (value < rhsValue) {\n        rhsValue = value;\n        leavingRowIndex = r;\n      }\n    } // If nothing is strictly smaller than 0; we're done with phase 1.\n\n\n    if (leavingRowIndex === 0) {\n      // Feasible, champagne!\n      this.feasible = true;\n      return iterations;\n    } // Selecting entering variable\n\n\n    var enteringColumn = 0;\n    var maxQuotient = -Infinity;\n    var costRow = matrix[0];\n    var leavingRow = matrix[leavingRowIndex];\n\n    for (var c = 1; c <= lastColumn; c++) {\n      var coefficient = leavingRow[c];\n\n      if (-this.precision < coefficient && coefficient < this.precision) {\n        continue;\n      }\n\n      unrestricted = this.unrestrictedVars[this.varIndexByCol[c]] === true;\n\n      if (unrestricted || coefficient < -this.precision) {\n        var quotient = -costRow[c] / coefficient;\n\n        if (maxQuotient < quotient) {\n          maxQuotient = quotient;\n          enteringColumn = c;\n        }\n      }\n    }\n\n    if (enteringColumn === 0) {\n      // Not feasible\n      this.feasible = false;\n      return iterations;\n    }\n\n    if (debugCheckForCycles) {\n      varIndexesCycle.push([this.varIndexByRow[leavingRowIndex], this.varIndexByCol[enteringColumn]]);\n      var cycleData = this.checkForCycles(varIndexesCycle);\n\n      if (cycleData.length > 0) {\n        console.log(\"Cycle in phase 1\");\n        console.log(\"Start :\", cycleData[0]);\n        console.log(\"Length :\", cycleData[1]);\n        throw new Error();\n      }\n    }\n\n    this.pivot(leavingRowIndex, enteringColumn);\n    iterations += 1;\n  }\n}; //-------------------------------------------------------------------\n// Description: Apply simplex to obtain optimal solution\n//              used as phase2 of the simplex\n//\n//-------------------------------------------------------------------\n\n\nTableau.prototype.phase2 = function () {\n  var debugCheckForCycles = this.model.checkForCycles;\n  var varIndexesCycle = [];\n  var matrix = this.matrix;\n  var rhsColumn = this.rhsColumn;\n  var lastColumn = this.width - 1;\n  var lastRow = this.height - 1;\n  var precision = this.precision;\n  var nOptionalObjectives = this.optionalObjectives.length;\n  var optionalCostsColumns = null;\n  var iterations = 0;\n  var reducedCost, unrestricted;\n\n  while (true) {\n    var costRow = matrix[this.costRowIndex]; // Selecting entering variable (optimality condition)\n\n    if (nOptionalObjectives > 0) {\n      optionalCostsColumns = [];\n    }\n\n    var enteringColumn = 0;\n    var enteringValue = precision;\n    var isReducedCostNegative = false;\n\n    for (var c = 1; c <= lastColumn; c++) {\n      reducedCost = costRow[c];\n      unrestricted = this.unrestrictedVars[this.varIndexByCol[c]] === true;\n\n      if (nOptionalObjectives > 0 && -precision < reducedCost && reducedCost < precision) {\n        optionalCostsColumns.push(c);\n        continue;\n      }\n\n      if (unrestricted && reducedCost < 0) {\n        if (-reducedCost > enteringValue) {\n          enteringValue = -reducedCost;\n          enteringColumn = c;\n          isReducedCostNegative = true;\n        }\n\n        continue;\n      }\n\n      if (reducedCost > enteringValue) {\n        enteringValue = reducedCost;\n        enteringColumn = c;\n        isReducedCostNegative = false;\n      }\n    }\n\n    if (nOptionalObjectives > 0) {\n      // There exist optional improvable objectives\n      var o = 0;\n\n      while (enteringColumn === 0 && optionalCostsColumns.length > 0 && o < nOptionalObjectives) {\n        var optionalCostsColumns2 = [];\n        var reducedCosts = this.optionalObjectives[o].reducedCosts;\n        enteringValue = precision;\n\n        for (var i = 0; i < optionalCostsColumns.length; i++) {\n          c = optionalCostsColumns[i];\n          reducedCost = reducedCosts[c];\n          unrestricted = this.unrestrictedVars[this.varIndexByCol[c]] === true;\n\n          if (-precision < reducedCost && reducedCost < precision) {\n            optionalCostsColumns2.push(c);\n            continue;\n          }\n\n          if (unrestricted && reducedCost < 0) {\n            if (-reducedCost > enteringValue) {\n              enteringValue = -reducedCost;\n              enteringColumn = c;\n              isReducedCostNegative = true;\n            }\n\n            continue;\n          }\n\n          if (reducedCost > enteringValue) {\n            enteringValue = reducedCost;\n            enteringColumn = c;\n            isReducedCostNegative = false;\n          }\n        }\n\n        optionalCostsColumns = optionalCostsColumns2;\n        o += 1;\n      }\n    } // If no entering column could be found we're done with phase 2.\n\n\n    if (enteringColumn === 0) {\n      this.setEvaluation();\n      return iterations;\n    } // Selecting leaving variable\n\n\n    var leavingRow = 0;\n    var minQuotient = Infinity;\n    var varIndexByRow = this.varIndexByRow;\n\n    for (var r = 1; r <= lastRow; r++) {\n      var row = matrix[r];\n      var rhsValue = row[rhsColumn];\n      var colValue = row[enteringColumn];\n\n      if (-precision < colValue && colValue < precision) {\n        continue;\n      }\n\n      if (colValue > 0 && precision > rhsValue && rhsValue > -precision) {\n        minQuotient = 0;\n        leavingRow = r;\n        break;\n      }\n\n      var quotient = isReducedCostNegative ? -rhsValue / colValue : rhsValue / colValue;\n\n      if (quotient > precision && minQuotient > quotient) {\n        minQuotient = quotient;\n        leavingRow = r;\n      }\n    }\n\n    if (minQuotient === Infinity) {\n      // optimal value is -Infinity\n      this.evaluation = -Infinity;\n      this.bounded = false;\n      this.unboundedVarIndex = this.varIndexByCol[enteringColumn];\n      return iterations;\n    }\n\n    if (debugCheckForCycles) {\n      varIndexesCycle.push([this.varIndexByRow[leavingRow], this.varIndexByCol[enteringColumn]]);\n      var cycleData = this.checkForCycles(varIndexesCycle);\n\n      if (cycleData.length > 0) {\n        console.log(\"Cycle in phase 2\");\n        console.log(\"Start :\", cycleData[0]);\n        console.log(\"Length :\", cycleData[1]);\n        throw new Error();\n      }\n    }\n\n    this.pivot(leavingRow, enteringColumn, true);\n    iterations += 1;\n  }\n}; // Array holding the column indexes for which the value is not null\n// on the pivot row\n// Shared by all tableaux for smaller overhead and lower memory usage\n\n\nvar nonZeroColumns = []; //-------------------------------------------------------------------\n// Description: Execute pivot operations over a 2d array,\n//          on a given row, and column\n//\n//-------------------------------------------------------------------\n\nTableau.prototype.pivot = function (pivotRowIndex, pivotColumnIndex) {\n  var matrix = this.matrix;\n  var quotient = matrix[pivotRowIndex][pivotColumnIndex];\n  var lastRow = this.height - 1;\n  var lastColumn = this.width - 1;\n  var leavingBasicIndex = this.varIndexByRow[pivotRowIndex];\n  var enteringBasicIndex = this.varIndexByCol[pivotColumnIndex];\n  this.varIndexByRow[pivotRowIndex] = enteringBasicIndex;\n  this.varIndexByCol[pivotColumnIndex] = leavingBasicIndex;\n  this.rowByVarIndex[enteringBasicIndex] = pivotRowIndex;\n  this.rowByVarIndex[leavingBasicIndex] = -1;\n  this.colByVarIndex[enteringBasicIndex] = -1;\n  this.colByVarIndex[leavingBasicIndex] = pivotColumnIndex; // Divide everything in the target row by the element @\n  // the target column\n\n  var pivotRow = matrix[pivotRowIndex];\n  var nNonZeroColumns = 0;\n\n  for (var c = 0; c <= lastColumn; c++) {\n    if (pivotRow[c] !== 0) {\n      pivotRow[c] /= quotient;\n      nonZeroColumns[nNonZeroColumns] = c;\n      nNonZeroColumns += 1;\n    }\n  }\n\n  pivotRow[pivotColumnIndex] = 1 / quotient; // for every row EXCEPT the pivot row,\n  // set the value in the pivot column = 0 by\n  // multiplying the value of all elements in the objective\n  // row by ... yuck... just look below; better explanation later\n\n  var coefficient, i, v0;\n  var precision = this.precision;\n\n  for (var r = 0; r <= lastRow; r++) {\n    var row = matrix[r];\n\n    if (r !== pivotRowIndex) {\n      coefficient = row[pivotColumnIndex]; // No point Burning Cycles if\n      // Zero to the thing\n\n      if (coefficient !== 0) {\n        for (i = 0; i < nNonZeroColumns; i++) {\n          c = nonZeroColumns[i]; // No point in doing math if you're just adding\n          // Zero to the thing\n\n          v0 = pivotRow[c];\n\n          if (v0 !== 0) {\n            row[c] = row[c] - coefficient * v0;\n          }\n        }\n\n        row[pivotColumnIndex] = -coefficient / quotient;\n      }\n    }\n  }\n\n  var nOptionalObjectives = this.optionalObjectives.length;\n\n  if (nOptionalObjectives > 0) {\n    for (var o = 0; o < nOptionalObjectives; o += 1) {\n      var reducedCosts = this.optionalObjectives[o].reducedCosts;\n      coefficient = reducedCosts[pivotColumnIndex];\n\n      if (coefficient !== 0) {\n        for (i = 0; i < nNonZeroColumns; i++) {\n          c = nonZeroColumns[i];\n          v0 = pivotRow[c];\n\n          if (v0 !== 0) {\n            reducedCosts[c] = reducedCosts[c] - coefficient * v0;\n          }\n        }\n\n        reducedCosts[pivotColumnIndex] = -coefficient / quotient;\n      }\n    }\n  }\n};\n\nTableau.prototype.checkForCycles = function (varIndexes) {\n  for (var e1 = 0; e1 < varIndexes.length - 1; e1++) {\n    for (var e2 = e1 + 1; e2 < varIndexes.length; e2++) {\n      var elt1 = varIndexes[e1];\n      var elt2 = varIndexes[e2];\n\n      if (elt1[0] === elt2[0] && elt1[1] === elt2[1]) {\n        if (e2 - e1 > varIndexes.length - e2) {\n          break;\n        }\n\n        var cycleFound = true;\n\n        for (var i = 1; i < e2 - e1; i++) {\n          var tmp1 = varIndexes[e1 + i];\n          var tmp2 = varIndexes[e2 + i];\n\n          if (tmp1[0] !== tmp2[0] || tmp1[1] !== tmp2[1]) {\n            cycleFound = false;\n            break;\n          }\n        }\n\n        if (cycleFound) {\n          return [e1, e2 - e1];\n        }\n      }\n    }\n  }\n\n  return [];\n};","/*global module*/\n\n/*global require*/\nvar Solution = require(\"./Solution.js\");\n\nfunction MilpSolution(tableau, evaluation, feasible, bounded, branchAndCutIterations) {\n  Solution.call(this, tableau, evaluation, feasible, bounded);\n  this.iter = branchAndCutIterations;\n}\n\nmodule.exports = MilpSolution;\nMilpSolution.prototype = Object.create(Solution.prototype);\nMilpSolution.constructor = MilpSolution;","/*global require*/\nvar Tableau = require(\"./Tableau.js\");\n\nvar SlackVariable = require(\"../expressions.js\").SlackVariable;\n\nTableau.prototype.addCutConstraints = function (cutConstraints) {\n  var nCutConstraints = cutConstraints.length;\n  var height = this.height;\n  var heightWithCuts = height + nCutConstraints; // Adding rows to hold cut constraints\n\n  for (var h = height; h < heightWithCuts; h += 1) {\n    if (this.matrix[h] === undefined) {\n      this.matrix[h] = this.matrix[h - 1].slice();\n    }\n  } // Adding cut constraints\n\n\n  this.height = heightWithCuts;\n  this.nVars = this.width + this.height - 2;\n  var c;\n  var lastColumn = this.width - 1;\n\n  for (var i = 0; i < nCutConstraints; i += 1) {\n    var cut = cutConstraints[i]; // Constraint row index\n\n    var r = height + i;\n    var sign = cut.type === \"min\" ? -1 : 1; // Variable on which the cut is applied\n\n    var varIndex = cut.varIndex;\n    var varRowIndex = this.rowByVarIndex[varIndex];\n    var constraintRow = this.matrix[r];\n\n    if (varRowIndex === -1) {\n      // Variable is non basic\n      constraintRow[this.rhsColumn] = sign * cut.value;\n\n      for (c = 1; c <= lastColumn; c += 1) {\n        constraintRow[c] = 0;\n      }\n\n      constraintRow[this.colByVarIndex[varIndex]] = sign;\n    } else {\n      // Variable is basic\n      var varRow = this.matrix[varRowIndex];\n      var varValue = varRow[this.rhsColumn];\n      constraintRow[this.rhsColumn] = sign * (cut.value - varValue);\n\n      for (c = 1; c <= lastColumn; c += 1) {\n        constraintRow[c] = -sign * varRow[c];\n      }\n    } // Creating slack variable\n\n\n    var slackVarIndex = this.getNewElementIndex();\n    this.varIndexByRow[r] = slackVarIndex;\n    this.rowByVarIndex[slackVarIndex] = r;\n    this.colByVarIndex[slackVarIndex] = -1;\n    this.variablesPerIndex[slackVarIndex] = new SlackVariable(\"s\" + slackVarIndex, slackVarIndex);\n    this.nVars += 1;\n  }\n};\n\nTableau.prototype._addLowerBoundMIRCut = function (rowIndex) {\n  if (rowIndex === this.costRowIndex) {\n    //console.log(\"! IN MIR CUTS : The index of the row corresponds to the cost row. !\");\n    return false;\n  }\n\n  var model = this.model;\n  var matrix = this.matrix;\n  var intVar = this.variablesPerIndex[this.varIndexByRow[rowIndex]];\n\n  if (!intVar.isInteger) {\n    return false;\n  }\n\n  var d = matrix[rowIndex][this.rhsColumn];\n  var frac_d = d - Math.floor(d);\n\n  if (frac_d < this.precision || 1 - this.precision < frac_d) {\n    return false;\n  } //Adding a row\n\n\n  var r = this.height;\n  matrix[r] = matrix[r - 1].slice();\n  this.height += 1; // Creating slack variable\n\n  this.nVars += 1;\n  var slackVarIndex = this.getNewElementIndex();\n  this.varIndexByRow[r] = slackVarIndex;\n  this.rowByVarIndex[slackVarIndex] = r;\n  this.colByVarIndex[slackVarIndex] = -1;\n  this.variablesPerIndex[slackVarIndex] = new SlackVariable(\"s\" + slackVarIndex, slackVarIndex);\n  matrix[r][this.rhsColumn] = Math.floor(d);\n\n  for (var colIndex = 1; colIndex < this.varIndexByCol.length; colIndex += 1) {\n    var variable = this.variablesPerIndex[this.varIndexByCol[colIndex]];\n\n    if (!variable.isInteger) {\n      matrix[r][colIndex] = Math.min(0, matrix[rowIndex][colIndex] / (1 - frac_d));\n    } else {\n      var coef = matrix[rowIndex][colIndex];\n      var termCoeff = Math.floor(coef) + Math.max(0, coef - Math.floor(coef) - frac_d) / (1 - frac_d);\n      matrix[r][colIndex] = termCoeff;\n    }\n  }\n\n  for (var c = 0; c < this.width; c += 1) {\n    matrix[r][c] -= matrix[rowIndex][c];\n  }\n\n  return true;\n};\n\nTableau.prototype._addUpperBoundMIRCut = function (rowIndex) {\n  if (rowIndex === this.costRowIndex) {\n    //console.log(\"! IN MIR CUTS : The index of the row corresponds to the cost row. !\");\n    return false;\n  }\n\n  var model = this.model;\n  var matrix = this.matrix;\n  var intVar = this.variablesPerIndex[this.varIndexByRow[rowIndex]];\n\n  if (!intVar.isInteger) {\n    return false;\n  }\n\n  var b = matrix[rowIndex][this.rhsColumn];\n  var f = b - Math.floor(b);\n\n  if (f < this.precision || 1 - this.precision < f) {\n    return false;\n  } //Adding a row\n\n\n  var r = this.height;\n  matrix[r] = matrix[r - 1].slice();\n  this.height += 1; // Creating slack variable\n\n  this.nVars += 1;\n  var slackVarIndex = this.getNewElementIndex();\n  this.varIndexByRow[r] = slackVarIndex;\n  this.rowByVarIndex[slackVarIndex] = r;\n  this.colByVarIndex[slackVarIndex] = -1;\n  this.variablesPerIndex[slackVarIndex] = new SlackVariable(\"s\" + slackVarIndex, slackVarIndex);\n  matrix[r][this.rhsColumn] = -f;\n\n  for (var colIndex = 1; colIndex < this.varIndexByCol.length; colIndex += 1) {\n    var variable = this.variablesPerIndex[this.varIndexByCol[colIndex]];\n    var aj = matrix[rowIndex][colIndex];\n    var fj = aj - Math.floor(aj);\n\n    if (variable.isInteger) {\n      if (fj <= f) {\n        matrix[r][colIndex] = -fj;\n      } else {\n        matrix[r][colIndex] = -(1 - fj) * f / fj;\n      }\n    } else {\n      if (aj >= 0) {\n        matrix[r][colIndex] = -aj;\n      } else {\n        matrix[r][colIndex] = aj * f / (1 - f);\n      }\n    }\n  }\n\n  return true;\n}; //\n// THIS MAKES SOME MILP PROBLEMS PROVIDE INCORRECT\n// ANSWERS...\n//\n// QUICK FIX: MAKE THE FUNCTION EMPTY...\n//\n\n\nTableau.prototype.applyMIRCuts = function () {// var nRows = this.height;\n  // for (var cst = 0; cst < nRows; cst += 1) {\n  //    this._addUpperBoundMIRCut(cst);\n  // }\n  // // nRows = tableau.height;\n  // for (cst = 0; cst < nRows; cst += 1) {\n  //    this._addLowerBoundMIRCut(cst);\n  // }\n};","/*global require*/\n\n/*global console*/\nvar Tableau = require(\"./Tableau.js\"); //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nTableau.prototype._putInBase = function (varIndex) {\n  // Is varIndex in the base?\n  var r = this.rowByVarIndex[varIndex];\n\n  if (r === -1) {\n    // Outside the base\n    // pivoting to take it out\n    var c = this.colByVarIndex[varIndex]; // Selecting pivot row\n    // (Any row with coefficient different from 0)\n\n    for (var r1 = 1; r1 < this.height; r1 += 1) {\n      var coefficient = this.matrix[r1][c];\n\n      if (coefficient < -this.precision || this.precision < coefficient) {\n        r = r1;\n        break;\n      }\n    }\n\n    this.pivot(r, c);\n  }\n\n  return r;\n};\n\nTableau.prototype._takeOutOfBase = function (varIndex) {\n  // Is varIndex in the base?\n  var c = this.colByVarIndex[varIndex];\n\n  if (c === -1) {\n    // Inside the base\n    // pivoting to take it out\n    var r = this.rowByVarIndex[varIndex]; // Selecting pivot column\n    // (Any column with coefficient different from 0)\n\n    var pivotRow = this.matrix[r];\n\n    for (var c1 = 1; c1 < this.height; c1 += 1) {\n      var coefficient = pivotRow[c1];\n\n      if (coefficient < -this.precision || this.precision < coefficient) {\n        c = c1;\n        break;\n      }\n    }\n\n    this.pivot(r, c);\n  }\n\n  return c;\n};\n\nTableau.prototype.updateVariableValues = function () {\n  var nVars = this.variables.length;\n  var roundingCoeff = Math.round(1 / this.precision);\n\n  for (var v = 0; v < nVars; v += 1) {\n    var variable = this.variables[v];\n    var varIndex = variable.index;\n    var r = this.rowByVarIndex[varIndex];\n\n    if (r === -1) {\n      // Variable is non basic\n      variable.value = 0;\n    } else {\n      // Variable is basic\n      var varValue = this.matrix[r][this.rhsColumn];\n      variable.value = Math.round(varValue * roundingCoeff) / roundingCoeff;\n    }\n  }\n};\n\nTableau.prototype.updateRightHandSide = function (constraint, difference) {\n  // Updates RHS of given constraint\n  var lastRow = this.height - 1;\n  var constraintRow = this.rowByVarIndex[constraint.index];\n\n  if (constraintRow === -1) {\n    // Slack is not in base\n    var slackColumn = this.colByVarIndex[constraint.index]; // Upading all the RHS values\n\n    for (var r = 0; r <= lastRow; r += 1) {\n      var row = this.matrix[r];\n      row[this.rhsColumn] -= difference * row[slackColumn];\n    }\n\n    var nOptionalObjectives = this.optionalObjectives.length;\n\n    if (nOptionalObjectives > 0) {\n      for (var o = 0; o < nOptionalObjectives; o += 1) {\n        var reducedCosts = this.optionalObjectives[o].reducedCosts;\n        reducedCosts[this.rhsColumn] -= difference * reducedCosts[slackColumn];\n      }\n    }\n  } else {\n    // Slack variable of constraint is in base\n    // Updating RHS with the difference between the old and the new one\n    this.matrix[constraintRow][this.rhsColumn] -= difference;\n  }\n};\n\nTableau.prototype.updateConstraintCoefficient = function (constraint, variable, difference) {\n  // Updates variable coefficient within a constraint\n  if (constraint.index === variable.index) {\n    throw new Error(\"[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !\");\n  }\n\n  var r = this._putInBase(constraint.index);\n\n  var colVar = this.colByVarIndex[variable.index];\n\n  if (colVar === -1) {\n    var rowVar = this.rowByVarIndex[variable.index];\n\n    for (var c = 0; c < this.width; c += 1) {\n      this.matrix[r][c] += difference * this.matrix[rowVar][c];\n    }\n  } else {\n    this.matrix[r][colVar] -= difference;\n  }\n};\n\nTableau.prototype.updateCost = function (variable, difference) {\n  // Updates variable coefficient within the objective function\n  var varIndex = variable.index;\n  var lastColumn = this.width - 1;\n  var varColumn = this.colByVarIndex[varIndex];\n\n  if (varColumn === -1) {\n    // Variable is in base\n    var variableRow = this.matrix[this.rowByVarIndex[varIndex]];\n    var c;\n\n    if (variable.priority === 0) {\n      var costRow = this.matrix[0]; // Upading all the reduced costs\n\n      for (c = 0; c <= lastColumn; c += 1) {\n        costRow[c] += difference * variableRow[c];\n      }\n    } else {\n      var reducedCosts = this.objectivesByPriority[variable.priority].reducedCosts;\n\n      for (c = 0; c <= lastColumn; c += 1) {\n        reducedCosts[c] += difference * variableRow[c];\n      }\n    }\n  } else {\n    // Variable is not in the base\n    // Updating coefficient with difference\n    this.matrix[0][varColumn] -= difference;\n  }\n};\n\nTableau.prototype.addConstraint = function (constraint) {\n  // Adds a constraint to the tableau\n  var sign = constraint.isUpperBound ? 1 : -1;\n  var lastRow = this.height;\n  var constraintRow = this.matrix[lastRow];\n\n  if (constraintRow === undefined) {\n    constraintRow = this.matrix[0].slice();\n    this.matrix[lastRow] = constraintRow;\n  } // Setting all row cells to 0\n\n\n  var lastColumn = this.width - 1;\n\n  for (var c = 0; c <= lastColumn; c += 1) {\n    constraintRow[c] = 0;\n  } // Initializing RHS\n\n\n  constraintRow[this.rhsColumn] = sign * constraint.rhs;\n  var terms = constraint.terms;\n  var nTerms = terms.length;\n\n  for (var t = 0; t < nTerms; t += 1) {\n    var term = terms[t];\n    var coefficient = term.coefficient;\n    var varIndex = term.variable.index;\n    var varRowIndex = this.rowByVarIndex[varIndex];\n\n    if (varRowIndex === -1) {\n      // Variable is non basic\n      constraintRow[this.colByVarIndex[varIndex]] += sign * coefficient;\n    } else {\n      // Variable is basic\n      var varRow = this.matrix[varRowIndex];\n      var varValue = varRow[this.rhsColumn];\n\n      for (c = 0; c <= lastColumn; c += 1) {\n        constraintRow[c] -= sign * coefficient * varRow[c];\n      }\n    }\n  } // Creating slack variable\n\n\n  var slackIndex = constraint.index;\n  this.varIndexByRow[lastRow] = slackIndex;\n  this.rowByVarIndex[slackIndex] = lastRow;\n  this.colByVarIndex[slackIndex] = -1;\n  this.height += 1;\n};\n\nTableau.prototype.removeConstraint = function (constraint) {\n  var slackIndex = constraint.index;\n  var lastRow = this.height - 1; // Putting the constraint's slack in the base\n\n  var r = this._putInBase(slackIndex); // Removing constraint\n  // by putting the corresponding row at the bottom of the matrix\n  // and virtually reducing the height of the matrix by 1\n\n\n  var tmpRow = this.matrix[lastRow];\n  this.matrix[lastRow] = this.matrix[r];\n  this.matrix[r] = tmpRow; // Removing associated slack variable from basic variables\n\n  this.varIndexByRow[r] = this.varIndexByRow[lastRow];\n  this.varIndexByRow[lastRow] = -1;\n  this.rowByVarIndex[slackIndex] = -1; // Putting associated slack variable index in index manager\n\n  this.availableIndexes[this.availableIndexes.length] = slackIndex;\n  constraint.slack.index = -1;\n  this.height -= 1;\n};\n\nTableau.prototype.addVariable = function (variable) {\n  // Adds a variable to the tableau\n  // var sign = constraint.isUpperBound ? 1 : -1;\n  var lastRow = this.height - 1;\n  var lastColumn = this.width;\n  var cost = this.model.isMinimization === true ? -variable.cost : variable.cost;\n  var priority = variable.priority; // Setting reduced costs\n\n  var nOptionalObjectives = this.optionalObjectives.length;\n\n  if (nOptionalObjectives > 0) {\n    for (var o = 0; o < nOptionalObjectives; o += 1) {\n      this.optionalObjectives[o].reducedCosts[lastColumn] = 0;\n    }\n  }\n\n  if (priority === 0) {\n    this.matrix[0][lastColumn] = cost;\n  } else {\n    this.setOptionalObjective(priority, lastColumn, cost);\n    this.matrix[0][lastColumn] = 0;\n  } // Setting all other column cells to 0\n\n\n  for (var r = 1; r <= lastRow; r += 1) {\n    this.matrix[r][lastColumn] = 0;\n  } // Adding variable to trackers\n\n\n  var varIndex = variable.index;\n  this.varIndexByCol[lastColumn] = varIndex;\n  this.rowByVarIndex[varIndex] = -1;\n  this.colByVarIndex[varIndex] = lastColumn;\n  this.width += 1;\n};\n\nTableau.prototype.removeVariable = function (variable) {\n  var varIndex = variable.index; // Putting the variable out of the base\n\n  var c = this._takeOutOfBase(varIndex);\n\n  var lastColumn = this.width - 1;\n\n  if (c !== lastColumn) {\n    var lastRow = this.height - 1;\n\n    for (var r = 0; r <= lastRow; r += 1) {\n      var row = this.matrix[r];\n      row[c] = row[lastColumn];\n    }\n\n    var nOptionalObjectives = this.optionalObjectives.length;\n\n    if (nOptionalObjectives > 0) {\n      for (var o = 0; o < nOptionalObjectives; o += 1) {\n        var reducedCosts = this.optionalObjectives[o].reducedCosts;\n        reducedCosts[c] = reducedCosts[lastColumn];\n      }\n    }\n\n    var switchVarIndex = this.varIndexByCol[lastColumn];\n    this.varIndexByCol[c] = switchVarIndex;\n    this.colByVarIndex[switchVarIndex] = c;\n  } // Removing variable from non basic variables\n\n\n  this.varIndexByCol[lastColumn] = -1;\n  this.colByVarIndex[varIndex] = -1; // Adding index into index manager\n\n  this.availableIndexes[this.availableIndexes.length] = varIndex;\n  variable.index = -1;\n  this.width -= 1;\n};","/*global require*/\n\n/*global console*/\nvar Tableau = require(\"./Tableau.js\"); //-------------------------------------------------------------------\n// Description: Display a tableau matrix\n//              and additional tableau information\n//\n//-------------------------------------------------------------------\n\n\nTableau.prototype.log = function (message, force) {\n  if (false && !force) {\n    return;\n  }\n\n  console.log(\"****\", message, \"****\");\n  console.log(\"Nb Variables\", this.width - 1);\n  console.log(\"Nb Constraints\", this.height - 1); // console.log(\"Variable Ids\", this.variablesPerIndex);\n\n  console.log(\"Basic Indexes\", this.varIndexByRow);\n  console.log(\"Non Basic Indexes\", this.varIndexByCol);\n  console.log(\"Rows\", this.rowByVarIndex);\n  console.log(\"Cols\", this.colByVarIndex);\n  var digitPrecision = 5; // Variable declaration\n\n  var varNameRowString = \"\",\n      spacePerColumn = [\" \"],\n      j,\n      c,\n      s,\n      r,\n      variable,\n      varIndex,\n      varName,\n      varNameLength,\n      nSpaces,\n      valueSpace,\n      nameSpace;\n  var row, rowString;\n\n  for (c = 1; c < this.width; c += 1) {\n    varIndex = this.varIndexByCol[c];\n    variable = this.variablesPerIndex[varIndex];\n\n    if (variable === undefined) {\n      varName = \"c\" + varIndex;\n    } else {\n      varName = variable.id;\n    }\n\n    varNameLength = varName.length;\n    nSpaces = Math.abs(varNameLength - 5);\n    valueSpace = \" \";\n    nameSpace = \"\\t\"; ///////////\n\n    /*valueSpace = \" \";\r\n    nameSpace = \" \";\r\n      for (s = 0; s < nSpaces; s += 1) {\r\n        if (varNameLength > 5) {\r\n            valueSpace += \" \";\r\n        } else {\r\n            nameSpace += \" \";\r\n        }\r\n    }*/\n    ///////////\n\n    if (varNameLength > 5) {\n      valueSpace += \" \";\n    } else {\n      nameSpace += \"\\t\";\n    }\n\n    spacePerColumn[c] = valueSpace;\n    varNameRowString += nameSpace + varName;\n  }\n\n  console.log(varNameRowString);\n  var signSpace; // Displaying reduced costs\n\n  var firstRow = this.matrix[this.costRowIndex];\n  var firstRowString = \"\\t\"; ///////////\n\n  /*for (j = 1; j < this.width; j += 1) {\r\n      signSpace = firstRow[j] < 0 ? \"\" : \" \";\r\n      firstRowString += signSpace;\r\n      firstRowString += spacePerColumn[j];\r\n      firstRowString += firstRow[j].toFixed(2);\r\n  }\r\n  signSpace = firstRow[0] < 0 ? \"\" : \" \";\r\n  firstRowString += signSpace + spacePerColumn[0] +\r\n      firstRow[0].toFixed(2);\r\n  console.log(firstRowString + \" Z\");*/\n  ///////////\n\n  for (j = 1; j < this.width; j += 1) {\n    signSpace = \"\\t\";\n    firstRowString += signSpace;\n    firstRowString += spacePerColumn[j];\n    firstRowString += firstRow[j].toFixed(digitPrecision);\n  }\n\n  signSpace = \"\\t\";\n  firstRowString += signSpace + spacePerColumn[0] + firstRow[0].toFixed(digitPrecision);\n  console.log(firstRowString + \"\\tZ\"); // Then the basic variable rowByVarIndex\n\n  for (r = 1; r < this.height; r += 1) {\n    row = this.matrix[r];\n    rowString = \"\\t\"; ///////////\n\n    /*for (c = 1; c < this.width; c += 1) {\r\n        signSpace = row[c] < 0 ? \"\" : \" \";\r\n        rowString += signSpace + spacePerColumn[c] + row[c].toFixed(2);\r\n    }\r\n    signSpace = row[0] < 0 ? \"\" : \" \";\r\n    rowString += signSpace + spacePerColumn[0] + row[0].toFixed(2);*/\n    ///////////\n\n    for (c = 1; c < this.width; c += 1) {\n      signSpace = \"\\t\";\n      rowString += signSpace + spacePerColumn[c] + row[c].toFixed(digitPrecision);\n    }\n\n    signSpace = \"\\t\";\n    rowString += signSpace + spacePerColumn[0] + row[0].toFixed(digitPrecision);\n    varIndex = this.varIndexByRow[r];\n    variable = this.variablesPerIndex[varIndex];\n\n    if (variable === undefined) {\n      varName = \"c\" + varIndex;\n    } else {\n      varName = variable.id;\n    }\n\n    console.log(rowString + \"\\t\" + varName);\n  }\n\n  console.log(\"\"); // Then reduced costs for optional objectives\n\n  var nOptionalObjectives = this.optionalObjectives.length;\n\n  if (nOptionalObjectives > 0) {\n    console.log(\"    Optional objectives:\");\n\n    for (var o = 0; o < nOptionalObjectives; o += 1) {\n      var reducedCosts = this.optionalObjectives[o].reducedCosts;\n      var reducedCostsString = \"\";\n\n      for (j = 1; j < this.width; j += 1) {\n        signSpace = reducedCosts[j] < 0 ? \"\" : \" \";\n        reducedCostsString += signSpace;\n        reducedCostsString += spacePerColumn[j];\n        reducedCostsString += reducedCosts[j].toFixed(digitPrecision);\n      }\n\n      signSpace = reducedCosts[0] < 0 ? \"\" : \" \";\n      reducedCostsString += signSpace + spacePerColumn[0] + reducedCosts[0].toFixed(digitPrecision);\n      console.log(reducedCostsString + \" z\" + o);\n    }\n  }\n\n  console.log(\"Feasible?\", this.feasible);\n  console.log(\"evaluation\", this.evaluation);\n  return this;\n};","/*global require*/\nvar Tableau = require(\"./Tableau.js\");\n\nTableau.prototype.copy = function () {\n  var copy = new Tableau(this.precision);\n  copy.width = this.width;\n  copy.height = this.height;\n  copy.nVars = this.nVars;\n  copy.model = this.model; // Making a shallow copy of integer variable indexes\n  // and variable ids\n\n  copy.variables = this.variables;\n  copy.variablesPerIndex = this.variablesPerIndex;\n  copy.unrestrictedVars = this.unrestrictedVars;\n  copy.lastElementIndex = this.lastElementIndex; // All the other arrays are deep copied\n\n  copy.varIndexByRow = this.varIndexByRow.slice();\n  copy.varIndexByCol = this.varIndexByCol.slice();\n  copy.rowByVarIndex = this.rowByVarIndex.slice();\n  copy.colByVarIndex = this.colByVarIndex.slice();\n  copy.availableIndexes = this.availableIndexes.slice();\n  var optionalObjectivesCopy = [];\n\n  for (var o = 0; o < this.optionalObjectives.length; o++) {\n    optionalObjectivesCopy[o] = this.optionalObjectives[o].copy();\n  }\n\n  copy.optionalObjectives = optionalObjectivesCopy;\n  var matrix = this.matrix;\n  var matrixCopy = new Array(this.height);\n\n  for (var r = 0; r < this.height; r++) {\n    matrixCopy[r] = matrix[r].slice();\n  }\n\n  copy.matrix = matrixCopy;\n  return copy;\n};\n\nTableau.prototype.save = function () {\n  this.savedState = this.copy();\n};\n\nTableau.prototype.restore = function () {\n  if (this.savedState === null) {\n    return;\n  }\n\n  var save = this.savedState;\n  var savedMatrix = save.matrix;\n  this.nVars = save.nVars;\n  this.model = save.model; // Shallow restore\n\n  this.variables = save.variables;\n  this.variablesPerIndex = save.variablesPerIndex;\n  this.unrestrictedVars = save.unrestrictedVars;\n  this.lastElementIndex = save.lastElementIndex;\n  this.width = save.width;\n  this.height = save.height; // Restoring matrix\n\n  var r, c;\n\n  for (r = 0; r < this.height; r += 1) {\n    var savedRow = savedMatrix[r];\n    var row = this.matrix[r];\n\n    for (c = 0; c < this.width; c += 1) {\n      row[c] = savedRow[c];\n    }\n  } // Restoring all the other structures\n\n\n  var savedBasicIndexes = save.varIndexByRow;\n\n  for (c = 0; c < this.height; c += 1) {\n    this.varIndexByRow[c] = savedBasicIndexes[c];\n  }\n\n  while (this.varIndexByRow.length > this.height) {\n    this.varIndexByRow.pop();\n  }\n\n  var savedNonBasicIndexes = save.varIndexByCol;\n\n  for (r = 0; r < this.width; r += 1) {\n    this.varIndexByCol[r] = savedNonBasicIndexes[r];\n  }\n\n  while (this.varIndexByCol.length > this.width) {\n    this.varIndexByCol.pop();\n  }\n\n  var savedRows = save.rowByVarIndex;\n  var savedCols = save.colByVarIndex;\n\n  for (var v = 0; v < this.nVars; v += 1) {\n    this.rowByVarIndex[v] = savedRows[v];\n    this.colByVarIndex[v] = savedCols[v];\n  }\n\n  if (save.optionalObjectives.length > 0 && this.optionalObjectives.length > 0) {\n    this.optionalObjectives = [];\n    this.optionalObjectivePerPriority = {};\n\n    for (var o = 0; o < save.optionalObjectives.length; o++) {\n      var optionalObjectiveCopy = save.optionalObjectives[o].copy();\n      this.optionalObjectives[o] = optionalObjectiveCopy;\n      this.optionalObjectivePerPriority[optionalObjectiveCopy.priority] = optionalObjectiveCopy;\n    }\n  }\n};","/*global require*/\nvar Tableau = require(\"./Tableau.js\");\n\nfunction VariableData(index, value) {\n  this.index = index;\n  this.value = value;\n} //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nTableau.prototype.getMostFractionalVar = function () {\n  var biggestFraction = 0;\n  var selectedVarIndex = null;\n  var selectedVarValue = null;\n  var mid = 0.5;\n  var integerVariables = this.model.integerVariables;\n  var nIntegerVars = integerVariables.length;\n\n  for (var v = 0; v < nIntegerVars; v++) {\n    var varIndex = integerVariables[v].index;\n    var varRow = this.rowByVarIndex[varIndex];\n\n    if (varRow === -1) {\n      continue;\n    }\n\n    var varValue = this.matrix[varRow][this.rhsColumn];\n    var fraction = Math.abs(varValue - Math.round(varValue));\n\n    if (biggestFraction < fraction) {\n      biggestFraction = fraction;\n      selectedVarIndex = varIndex;\n      selectedVarValue = varValue;\n    }\n  }\n\n  return new VariableData(selectedVarIndex, selectedVarValue);\n}; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nTableau.prototype.getFractionalVarWithLowestCost = function () {\n  var highestCost = Infinity;\n  var selectedVarIndex = null;\n  var selectedVarValue = null;\n  var integerVariables = this.model.integerVariables;\n  var nIntegerVars = integerVariables.length;\n\n  for (var v = 0; v < nIntegerVars; v++) {\n    var variable = integerVariables[v];\n    var varIndex = variable.index;\n    var varRow = this.rowByVarIndex[varIndex];\n\n    if (varRow === -1) {\n      // Variable value is non basic\n      // its value is 0\n      continue;\n    }\n\n    var varValue = this.matrix[varRow][this.rhsColumn];\n\n    if (Math.abs(varValue - Math.round(varValue)) > this.precision) {\n      var cost = variable.cost;\n\n      if (highestCost > cost) {\n        highestCost = cost;\n        selectedVarIndex = varIndex;\n        selectedVarValue = varValue;\n      }\n    }\n  }\n\n  return new VariableData(selectedVarIndex, selectedVarValue);\n};","/*global require*/\nvar Tableau = require(\"./Tableau.js\");\n\nTableau.prototype.countIntegerValues = function () {\n  var count = 0;\n\n  for (var r = 1; r < this.height; r += 1) {\n    if (this.variablesPerIndex[this.varIndexByRow[r]].isInteger) {\n      var decimalPart = this.matrix[r][this.rhsColumn];\n      decimalPart = decimalPart - Math.floor(decimalPart);\n\n      if (decimalPart < this.precision && -decimalPart < this.precision) {\n        count += 1;\n      }\n    }\n  }\n\n  return count;\n}; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nTableau.prototype.isIntegral = function () {\n  var integerVariables = this.model.integerVariables;\n  var nIntegerVars = integerVariables.length;\n\n  for (var v = 0; v < nIntegerVars; v++) {\n    var varRow = this.rowByVarIndex[integerVariables[v].index];\n\n    if (varRow === -1) {\n      continue;\n    }\n\n    var varValue = this.matrix[varRow][this.rhsColumn];\n\n    if (Math.abs(varValue - Math.round(varValue)) > this.precision) {\n      return false;\n    }\n  }\n\n  return true;\n}; // Multiply all the fractional parts of variables supposed to be integer\n\n\nTableau.prototype.computeFractionalVolume = function (ignoreIntegerValues) {\n  var volume = -1; // var integerVariables = this.model.integerVariables;\n  // var nIntegerVars = integerVariables.length;\n  // for (var v = 0; v < nIntegerVars; v++) {\n  //     var r = this.rowByVarIndex[integerVariables[v].index];\n  //     if (r === -1) {\n  //         continue;\n  //     }\n  //     var rhs = this.matrix[r][this.rhsColumn];\n  //     rhs = Math.abs(rhs);\n  //     var decimalPart = Math.min(rhs - Math.floor(rhs), Math.floor(rhs + 1));\n  //     if (decimalPart < this.precision) {\n  //         if (!ignoreIntegerValues) {\n  //             return 0;\n  //         }\n  //     } else {\n  //         if (volume === -1) {\n  //             volume = rhs;\n  //         } else {\n  //             volume *= rhs;\n  //         }\n  //     }\n  // }\n\n  for (var r = 1; r < this.height; r += 1) {\n    if (this.variablesPerIndex[this.varIndexByRow[r]].isInteger) {\n      var rhs = this.matrix[r][this.rhsColumn];\n      rhs = Math.abs(rhs);\n      var decimalPart = Math.min(rhs - Math.floor(rhs), Math.floor(rhs + 1));\n\n      if (decimalPart < this.precision) {\n        if (!ignoreIntegerValues) {\n          return 0;\n        }\n      } else {\n        if (volume === -1) {\n          volume = rhs;\n        } else {\n          volume *= rhs;\n        }\n      }\n    }\n  }\n\n  if (volume === -1) {\n    return 0;\n  }\n\n  return volume;\n};","/*global describe*/\n\n/*global require*/\n\n/*global module*/\n\n/*global it*/\n\n/*global console*/\n\n/*global process*/\nvar Tableau = require(\"./Tableau/Tableau.js\");\n\nvar branchAndCut = require(\"./Tableau/branchAndCut.js\");\n\nvar expressions = require(\"./expressions.js\");\n\nvar Constraint = expressions.Constraint;\nvar Equality = expressions.Equality;\nvar Variable = expressions.Variable;\nvar IntegerVariable = expressions.IntegerVariable;\nvar Term = expressions.Term;\n/*************************************************************\r\n * Class: Model\r\n * Description: Holds the model of a linear optimisation problem\r\n **************************************************************/\n\nfunction Model(precision, name) {\n  this.tableau = new Tableau(precision);\n  this.name = name;\n  this.variables = [];\n  this.integerVariables = [];\n  this.unrestrictedVariables = {};\n  this.constraints = [];\n  this.nConstraints = 0;\n  this.nVariables = 0;\n  this.isMinimization = true;\n  this.tableauInitialized = false;\n  this.relaxationIndex = 1;\n  this.useMIRCuts = true;\n  this.checkForCycles = false;\n}\n\nmodule.exports = Model;\n\nModel.prototype.minimize = function () {\n  this.isMinimization = true;\n  return this;\n};\n\nModel.prototype.maximize = function () {\n  this.isMinimization = false;\n  return this;\n}; // Model.prototype.addConstraint = function (constraint) {\n//     // TODO: make sure that the constraint does not belong do another model\n//     // and make\n//     this.constraints.push(constraint);\n//     return this;\n// };\n\n\nModel.prototype._getNewElementIndex = function () {\n  if (this.availableIndexes.length > 0) {\n    return this.availableIndexes.pop();\n  }\n\n  var index = this.lastElementIndex;\n  this.lastElementIndex += 1;\n  return index;\n};\n\nModel.prototype._addConstraint = function (constraint) {\n  var slackVariable = constraint.slack;\n  this.tableau.variablesPerIndex[slackVariable.index] = slackVariable;\n  this.constraints.push(constraint);\n  this.nConstraints += 1;\n\n  if (this.tableauInitialized === true) {\n    this.tableau.addConstraint(constraint);\n  }\n};\n\nModel.prototype.smallerThan = function (rhs) {\n  var constraint = new Constraint(rhs, true, this.tableau.getNewElementIndex(), this);\n\n  this._addConstraint(constraint);\n\n  return constraint;\n};\n\nModel.prototype.greaterThan = function (rhs) {\n  var constraint = new Constraint(rhs, false, this.tableau.getNewElementIndex(), this);\n\n  this._addConstraint(constraint);\n\n  return constraint;\n};\n\nModel.prototype.equal = function (rhs) {\n  var constraintUpper = new Constraint(rhs, true, this.tableau.getNewElementIndex(), this);\n\n  this._addConstraint(constraintUpper);\n\n  var constraintLower = new Constraint(rhs, false, this.tableau.getNewElementIndex(), this);\n\n  this._addConstraint(constraintLower);\n\n  return new Equality(constraintUpper, constraintLower);\n};\n\nModel.prototype.addVariable = function (cost, id, isInteger, isUnrestricted, priority) {\n  if (typeof priority === \"string\") {\n    switch (priority) {\n      case \"required\":\n        priority = 0;\n        break;\n\n      case \"strong\":\n        priority = 1;\n        break;\n\n      case \"medium\":\n        priority = 2;\n        break;\n\n      case \"weak\":\n        priority = 3;\n        break;\n\n      default:\n        priority = 0;\n        break;\n    }\n  }\n\n  var varIndex = this.tableau.getNewElementIndex();\n\n  if (id === null || id === undefined) {\n    id = \"v\" + varIndex;\n  }\n\n  if (cost === null || cost === undefined) {\n    cost = 0;\n  }\n\n  if (priority === null || priority === undefined) {\n    priority = 0;\n  }\n\n  var variable;\n\n  if (isInteger) {\n    variable = new IntegerVariable(id, cost, varIndex, priority);\n    this.integerVariables.push(variable);\n  } else {\n    variable = new Variable(id, cost, varIndex, priority);\n  }\n\n  this.variables.push(variable);\n  this.tableau.variablesPerIndex[varIndex] = variable;\n\n  if (isUnrestricted) {\n    this.unrestrictedVariables[varIndex] = true;\n  }\n\n  this.nVariables += 1;\n\n  if (this.tableauInitialized === true) {\n    this.tableau.addVariable(variable);\n  }\n\n  return variable;\n};\n\nModel.prototype._removeConstraint = function (constraint) {\n  var idx = this.constraints.indexOf(constraint);\n\n  if (idx === -1) {\n    console.warn(\"[Model.removeConstraint] Constraint not present in model\");\n    return;\n  }\n\n  this.constraints.splice(idx, 1);\n  this.nConstraints -= 1;\n\n  if (this.tableauInitialized === true) {\n    this.tableau.removeConstraint(constraint);\n  }\n\n  if (constraint.relaxation) {\n    this.removeVariable(constraint.relaxation);\n  }\n}; //-------------------------------------------------------------------\n// For dynamic model modification\n//-------------------------------------------------------------------\n\n\nModel.prototype.removeConstraint = function (constraint) {\n  if (constraint.isEquality) {\n    this._removeConstraint(constraint.upperBound);\n\n    this._removeConstraint(constraint.lowerBound);\n  } else {\n    this._removeConstraint(constraint);\n  }\n\n  return this;\n};\n\nModel.prototype.removeVariable = function (variable) {\n  var idx = this.variables.indexOf(variable);\n\n  if (idx === -1) {\n    console.warn(\"[Model.removeVariable] Variable not present in model\");\n    return;\n  }\n\n  this.variables.splice(idx, 1);\n\n  if (this.tableauInitialized === true) {\n    this.tableau.removeVariable(variable);\n  }\n\n  return this;\n};\n\nModel.prototype.updateRightHandSide = function (constraint, difference) {\n  if (this.tableauInitialized === true) {\n    this.tableau.updateRightHandSide(constraint, difference);\n  }\n\n  return this;\n};\n\nModel.prototype.updateConstraintCoefficient = function (constraint, variable, difference) {\n  if (this.tableauInitialized === true) {\n    this.tableau.updateConstraintCoefficient(constraint, variable, difference);\n  }\n\n  return this;\n};\n\nModel.prototype.setCost = function (cost, variable) {\n  var difference = cost - variable.cost;\n\n  if (this.isMinimization === false) {\n    difference = -difference;\n  }\n\n  variable.cost = cost;\n  this.tableau.updateCost(variable, difference);\n  return this;\n}; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nModel.prototype.loadJson = function (jsonModel) {\n  this.isMinimization = jsonModel.opType !== \"max\";\n  var variables = jsonModel.variables;\n  var constraints = jsonModel.constraints;\n  var constraintsMin = {};\n  var constraintsMax = {}; // Instantiating constraints\n\n  var constraintIds = Object.keys(constraints);\n  var nConstraintIds = constraintIds.length;\n\n  for (var c = 0; c < nConstraintIds; c += 1) {\n    var constraintId = constraintIds[c];\n    var constraint = constraints[constraintId];\n    var equal = constraint.equal;\n    var weight = constraint.weight;\n    var priority = constraint.priority;\n    var relaxed = weight !== undefined || priority !== undefined;\n    var lowerBound, upperBound;\n\n    if (equal === undefined) {\n      var min = constraint.min;\n\n      if (min !== undefined) {\n        lowerBound = this.greaterThan(min);\n        constraintsMin[constraintId] = lowerBound;\n\n        if (relaxed) {\n          lowerBound.relax(weight, priority);\n        }\n      }\n\n      var max = constraint.max;\n\n      if (max !== undefined) {\n        upperBound = this.smallerThan(max);\n        constraintsMax[constraintId] = upperBound;\n\n        if (relaxed) {\n          upperBound.relax(weight, priority);\n        }\n      }\n    } else {\n      lowerBound = this.greaterThan(equal);\n      constraintsMin[constraintId] = lowerBound;\n      upperBound = this.smallerThan(equal);\n      constraintsMax[constraintId] = upperBound;\n      var equality = new Equality(lowerBound, upperBound);\n\n      if (relaxed) {\n        equality.relax(weight, priority);\n      }\n    }\n  }\n\n  var variableIds = Object.keys(variables);\n  var nVariables = variableIds.length;\n  var integerVarIds = jsonModel.ints || {};\n  var binaryVarIds = jsonModel.binaries || {};\n  var unrestrictedVarIds = jsonModel.unrestricted || {}; // Instantiating variables and constraint terms\n\n  var objectiveName = jsonModel.optimize;\n\n  for (var v = 0; v < nVariables; v += 1) {\n    // Creation of the variables\n    var variableId = variableIds[v];\n    var variableConstraints = variables[variableId];\n    var cost = variableConstraints[objectiveName] || 0;\n    var isBinary = !!binaryVarIds[variableId];\n    var isInteger = !!integerVarIds[variableId] || isBinary;\n    var isUnrestricted = !!unrestrictedVarIds[variableId];\n    var variable = this.addVariable(cost, variableId, isInteger, isUnrestricted);\n\n    if (isBinary) {\n      // Creating an upperbound constraint for this variable\n      this.smallerThan(1).addTerm(1, variable);\n    }\n\n    var constraintNames = Object.keys(variableConstraints);\n\n    for (c = 0; c < constraintNames.length; c += 1) {\n      var constraintName = constraintNames[c];\n\n      if (constraintName === objectiveName) {\n        continue;\n      }\n\n      var coefficient = variableConstraints[constraintName];\n      var constraintMin = constraintsMin[constraintName];\n\n      if (constraintMin !== undefined) {\n        constraintMin.addTerm(coefficient, variable);\n      }\n\n      var constraintMax = constraintsMax[constraintName];\n\n      if (constraintMax !== undefined) {\n        constraintMax.addTerm(coefficient, variable);\n      }\n    }\n  }\n\n  return this;\n}; //-------------------------------------------------------------------\n//-------------------------------------------------------------------\n\n\nModel.prototype.getNumberOfIntegerVariables = function () {\n  return this.integerVariables.length;\n};\n\nModel.prototype.solve = function () {\n  // Setting tableau if not done\n  if (this.tableauInitialized === false) {\n    this.tableau.setModel(this);\n    this.tableauInitialized = true;\n  }\n\n  return this.tableau.solve();\n};\n\nModel.prototype.isFeasible = function () {\n  return this.tableau.feasible;\n};\n\nModel.prototype.save = function () {\n  return this.tableau.save();\n};\n\nModel.prototype.restore = function () {\n  return this.tableau.restore();\n};\n\nModel.prototype.activateMIRCuts = function (useMIRCuts) {\n  this.useMIRCuts = useMIRCuts;\n};\n\nModel.prototype.debug = function (debugCheckForCycles) {\n  this.checkForCycles = debugCheckForCycles;\n};\n\nModel.prototype.log = function (message) {\n  return this.tableau.log(message);\n};","/*global describe*/\n\n/*global require*/\n\n/*global module*/\n\n/*global it*/\n\n/*global console*/\n\n/*global process*/\n\n/*global exports*/\n// All functions in this module that\n// get exported to main ***MUST***\n// return a functional LPSolve JSON style\n// model or throw an error\nexports.CleanObjectiveAttributes = function (model) {\n  // Test to see if the objective attribute\n  // is also used by one of the constraints\n  //\n  // If so...create a new attribute on each\n  // variable\n  var fakeAttr, x, z;\n\n  if (typeof model.optimize === \"string\") {\n    if (model.constraints[model.optimize]) {\n      // Create the new attribute\n      fakeAttr = Math.random(); // Go over each variable and check\n\n      for (x in model.variables) {\n        // Is it there?\n        if (model.variables[x][model.optimize]) {\n          model.variables[x][fakeAttr] = model.variables[x][model.optimize];\n        }\n      } // Now that we've cleaned up the variables\n      // we need to clean up the constraints\n\n\n      model.constraints[fakeAttr] = model.constraints[model.optimize];\n      delete model.constraints[model.optimize];\n      return model;\n    } else {\n      return model;\n    }\n  } else {\n    // We're assuming its an object?\n    for (z in model.optimize) {\n      if (model.constraints[z]) {\n        // Make sure that the constraint\n        // being optimized isn't constrained\n        // by an equity collar\n        if (model.constraints[z] === \"equal\") {\n          // Its constrained by an equal sign;\n          // delete that objective and move on\n          delete model.optimize[z];\n        } else {\n          // Create the new attribute\n          fakeAttr = Math.random(); // Go over each variable and check\n\n          for (x in model.variables) {\n            // Is it there?\n            if (model.variables[x][z]) {\n              model.variables[x][fakeAttr] = model.variables[x][z];\n            }\n          } // Now that we've cleaned up the variables\n          // we need to clean up the constraints\n\n\n          model.constraints[fakeAttr] = model.constraints[z];\n          delete model.constraints[z];\n        }\n      }\n    }\n\n    return model;\n  }\n};","/*global describe*/\n\n/*global require*/\n\n/*global module*/\n\n/*global it*/\n\n/*global console*/\n\n/*global process*/\n\n/*jshint -W083 */\n\n/*************************************************************\r\n* Method: to_JSON\r\n* Scope: Public:\r\n* Agruments: input: Whatever the user gives us\r\n* Purpose: Convert an unfriendly formatted LP\r\n*          into something that our library can\r\n*          work with\r\n**************************************************************/\nfunction to_JSON(input) {\n  var rxo = {\n    /* jshint ignore:start */\n    \"is_blank\": /^\\W{0,}$/,\n    \"is_objective\": /(max|min)(imize){0,}\\:/i,\n    //previous version\n    //\"is_int\": /^\\W{0,}int/i,\n    //new version to avoid comments\n    \"is_int\": /^(?!\\/\\*)\\W{0,}int/i,\n    \"is_bin\": /^(?!\\/\\*)\\W{0,}bin/i,\n    \"is_constraint\": /(\\>|\\<){0,}\\=/i,\n    \"is_unrestricted\": /^\\S{0,}unrestricted/i,\n    \"parse_lhs\": /(\\-|\\+){0,1}\\s{0,1}\\d{0,}\\.{0,}\\d{0,}\\s{0,}[A-Za-z]\\S{0,}/gi,\n    \"parse_rhs\": /(\\-|\\+){0,1}\\d{1,}\\.{0,}\\d{0,}\\W{0,}\\;{0,1}$/i,\n    \"parse_dir\": /(\\>|\\<){0,}\\=/gi,\n    \"parse_int\": /[^\\s|^\\,]+/gi,\n    \"parse_bin\": /[^\\s|^\\,]+/gi,\n    \"get_num\": /(\\-|\\+){0,1}(\\W|^)\\d+\\.{0,1}\\d{0,}/g,\n    // Why accepting character \\W before the first digit?\n    \"get_word\": /[A-Za-z].*/\n    /* jshint ignore:end */\n\n  },\n      model = {\n    \"opType\": \"\",\n    \"optimize\": \"_obj\",\n    \"constraints\": {},\n    \"variables\": {}\n  },\n      constraints = {\n    \">=\": \"min\",\n    \"<=\": \"max\",\n    \"=\": \"equal\"\n  },\n      tmp = \"\",\n      tst = 0,\n      ary = null,\n      hldr = \"\",\n      hldr2 = \"\",\n      constraint = \"\",\n      rhs = 0; // Handle input if its coming\n  // to us as a hard string\n  // instead of as an array of\n  // strings\n\n  if (typeof input === \"string\") {\n    input = input.split(\"\\n\");\n  } // Start iterating over the rows\n  // to see what all we have\n\n\n  for (var i = 0; i < input.length; i++) {\n    constraint = \"__\" + i; // Get the string we're working with\n\n    tmp = input[i]; // Set the test = 0\n\n    tst = 0; // Reset the array\n\n    ary = null; // Test to see if we're the objective\n\n    if (rxo.is_objective.test(tmp)) {\n      // Set up in model the opType\n      model.opType = tmp.match(/(max|min)/gi)[0]; // Pull apart lhs\n\n      ary = tmp.match(rxo.parse_lhs).map(function (d) {\n        return d.replace(/\\s+/, \"\");\n      }).slice(1); // *** STEP 1 *** ///\n      // Get the variables out\n\n      ary.forEach(function (d) {\n        // Get the number if its there\n        hldr = d.match(rxo.get_num); // If it isn't a number, it might\n        // be a standalone variable\n\n        if (hldr === null) {\n          if (d.substr(0, 1) === \"-\") {\n            hldr = -1;\n          } else {\n            hldr = 1;\n          }\n        } else {\n          hldr = hldr[0];\n        }\n\n        hldr = parseFloat(hldr); // Get the variable type\n\n        hldr2 = d.match(rxo.get_word)[0].replace(/\\;$/, \"\"); // Make sure the variable is in the model\n\n        model.variables[hldr2] = model.variables[hldr2] || {};\n        model.variables[hldr2]._obj = hldr;\n      }); ////////////////////////////////////\n    } else if (rxo.is_int.test(tmp)) {\n      // Get the array of ints\n      ary = tmp.match(rxo.parse_int).slice(1); // Since we have an int, our model should too\n\n      model.ints = model.ints || {};\n      ary.forEach(function (d) {\n        d = d.replace(\";\", \"\");\n        model.ints[d] = 1;\n      }); ////////////////////////////////////\n    } else if (rxo.is_bin.test(tmp)) {\n      // Get the array of bins\n      ary = tmp.match(rxo.parse_bin).slice(1); // Since we have an binary, our model should too\n\n      model.binaries = model.binaries || {};\n      ary.forEach(function (d) {\n        d = d.replace(\";\", \"\");\n        model.binaries[d] = 1;\n      }); ////////////////////////////////////\n    } else if (rxo.is_constraint.test(tmp)) {\n      var separatorIndex = tmp.indexOf(\":\");\n      var constraintExpression = separatorIndex === -1 ? tmp : tmp.slice(separatorIndex + 1); // Pull apart lhs\n\n      ary = constraintExpression.match(rxo.parse_lhs).map(function (d) {\n        return d.replace(/\\s+/, \"\");\n      }); // *** STEP 1 *** ///\n      // Get the variables out\n\n      ary.forEach(function (d) {\n        // Get the number if its there\n        hldr = d.match(rxo.get_num);\n\n        if (hldr === null) {\n          if (d.substr(0, 1) === \"-\") {\n            hldr = -1;\n          } else {\n            hldr = 1;\n          }\n        } else {\n          hldr = hldr[0];\n        }\n\n        hldr = parseFloat(hldr); // Get the variable name\n\n        hldr2 = d.match(rxo.get_word)[0]; // Make sure the variable is in the model\n\n        model.variables[hldr2] = model.variables[hldr2] || {};\n        model.variables[hldr2][constraint] = hldr;\n      }); // *** STEP 2 *** ///\n      // Get the RHS out\n\n      rhs = parseFloat(tmp.match(rxo.parse_rhs)[0]); // *** STEP 3 *** ///\n      // Get the Constrainer out\n\n      tmp = constraints[tmp.match(rxo.parse_dir)[0]];\n      model.constraints[constraint] = model.constraints[constraint] || {};\n      model.constraints[constraint][tmp] = rhs; ////////////////////////////////////\n    } else if (rxo.is_unrestricted.test(tmp)) {\n      // Get the array of unrestricted\n      ary = tmp.match(rxo.parse_int).slice(1); // Since we have an int, our model should too\n\n      model.unrestricted = model.unrestricted || {};\n      ary.forEach(function (d) {\n        d = d.replace(\";\", \"\");\n        model.unrestricted[d] = 1;\n      });\n    }\n  }\n\n  return model;\n}\n/*************************************************************\r\n* Method: from_JSON\r\n* Scope: Public:\r\n* Agruments: model: The model we want solver to operate on\r\n* Purpose: Convert a friendly JSON model into a model for a\r\n*          real solving library...in this case\r\n*          lp_solver\r\n**************************************************************/\n\n\nfunction from_JSON(model) {\n  // Make sure we at least have a model\n  if (!model) {\n    throw new Error(\"Solver requires a model to operate on\");\n  }\n\n  var output = \"\",\n      ary = [],\n      norm = 1,\n      lookup = {\n    \"max\": \"<=\",\n    \"min\": \">=\",\n    \"equal\": \"=\"\n  },\n      rxClean = new RegExp(\"[^A-Za-z0-9]+\", \"gi\"); // Build the objective statement\n\n  output += model.opType + \":\"; // Iterate over the variables\n\n  for (var x in model.variables) {\n    // Give each variable a self of 1 unless\n    // it exists already\n    model.variables[x][x] = model.variables[x][x] ? model.variables[x][x] : 1; // Does our objective exist here?\n\n    if (model.variables[x][model.optimize]) {\n      output += \" \" + model.variables[x][model.optimize] + \" \" + x.replace(rxClean, \"_\");\n    }\n  } // Add some closure to our line thing\n\n\n  output += \";\\n\"; // And now... to iterate over the constraints\n\n  for (x in model.constraints) {\n    for (var y in model.constraints[x]) {\n      for (var z in model.variables) {\n        // Does our Constraint exist here?\n        if (model.variables[z][x]) {\n          output += \" \" + model.variables[z][x] + \" \" + z.replace(rxClean, \"_\");\n        }\n      } // Add the constraint type and value...\n\n\n      output += \" \" + lookup[y] + \" \" + model.constraints[x][y];\n      output += \";\\n\";\n    }\n  } // Are there any ints?\n\n\n  if (model.ints) {\n    output += \"\\n\\n\";\n\n    for (x in model.ints) {\n      output += \"int \" + x.replace(rxClean, \"_\") + \";\\n\";\n    }\n  } // Are there any unrestricted?\n\n\n  if (model.unrestricted) {\n    output += \"\\n\\n\";\n\n    for (x in model.unrestricted) {\n      output += \"unrestricted \" + x.replace(rxClean, \"_\") + \";\\n\";\n    }\n  } // And kick the string back\n\n\n  return output;\n}\n\nmodule.exports = function (model) {\n  // If the user is giving us an array\n  // or a string, convert it to a JSON Model\n  // otherwise, spit it out as a string\n  if (model.length) {\n    return to_JSON(model);\n  } else {\n    return from_JSON(model);\n  }\n};","/*global describe*/\n\n/*global require*/\n\n/*global module*/\n\n/*global it*/\n\n/*global console*/\n\n/*global process*/\n\n/***************************************************************\r\n * Method: polyopt\r\n * Scope: private\r\n * Agruments:\r\n *        model: The model we want solver to operate on.\r\n                 Because we're in here, we're assuming that\r\n                 we're solving a multi-objective optimization\r\n                 problem. Poly-Optimization. polyopt.\r\n                   This model has to be formed a little differently\r\n                 because it has multiple objective functions.\r\n                 Normally, a model has 2 attributes: opType (string,\r\n                 \"max\" or \"min\"), and optimize (string, whatever\r\n                 attribute we're optimizing.\r\n                   Now, there is no opType attribute on the model,\r\n                 and optimize is an object of attributes to be\r\n                 optimized, and how they're to be optimized.\r\n                 For example:\r\n                   ...\r\n                 \"optimize\": {\r\n                    \"pancakes\": \"max\",\r\n                    \"cost\": \"minimize\"\r\n                 }\r\n                 ...\r\n     **************************************************************/\nmodule.exports = function (solver, model) {\n  // I have no idea if this is actually works, or what,\n  // but here is my algorithm to solve linear programs\n  // with multiple objective functions\n  // 1. Optimize for each constraint\n  // 2. The results for each solution is a vector\n  //    representing a vertex on the polytope we're creating\n  // 3. The results for all solutions describes the shape\n  //    of the polytope (would be nice to have the equation\n  //    representing this)\n  // 4. Find the mid-point between all vertices by doing the\n  //    following (a_1 + a_2 ... a_n) / n;\n  var objectives = model.optimize,\n      new_constraints = JSON.parse(JSON.stringify(model.optimize)),\n      keys = Object.keys(model.optimize),\n      tmp,\n      counter = 0,\n      vectors = {},\n      vector_key = \"\",\n      obj = {},\n      pareto = [],\n      i,\n      j,\n      x,\n      y,\n      z; // Delete the optimize object from the model\n\n  delete model.optimize; // Iterate and Clear\n\n  for (i = 0; i < keys.length; i++) {\n    // Clean up the new_constraints\n    new_constraints[keys[i]] = 0;\n  } // Solve and add\n\n\n  for (i = 0; i < keys.length; i++) {\n    // Prep the model\n    model.optimize = keys[i];\n    model.opType = objectives[keys[i]]; // solve the model\n\n    tmp = solver.Solve(model, undefined, undefined, true); // Only the variables make it into the solution;\n    // not the attributes.\n    //\n    // Because of this, we have to add the attributes\n    // back onto the solution so we can do math with\n    // them later...\n    // Loop over the keys\n\n    for (y in keys) {\n      // We're only worried about attributes, not variables\n      if (!model.variables[keys[y]]) {\n        // Create space for the attribute in the tmp object\n        tmp[keys[y]] = tmp[keys[y]] ? tmp[keys[y]] : 0; // Go over each of the variables\n\n        for (x in model.variables) {\n          // Does the variable exist in tmp *and* does attribute exist in this model?\n          if (model.variables[x][keys[y]] && tmp[x]) {\n            // Add it to tmp\n            tmp[keys[y]] += tmp[x] * model.variables[x][keys[y]];\n          }\n        }\n      }\n    } // clear our key\n\n\n    vector_key = \"base\"; // this makes sure that if we get\n    // the same vector more than once,\n    // we only count it once when finding\n    // the midpoint\n\n    for (j = 0; j < keys.length; j++) {\n      if (tmp[keys[j]]) {\n        vector_key += \"-\" + (tmp[keys[j]] * 1000 | 0) / 1000;\n      } else {\n        vector_key += \"-0\";\n      }\n    } // Check here to ensure it doesn't exist\n\n\n    if (!vectors[vector_key]) {\n      // Add the vector-key in\n      vectors[vector_key] = 1;\n      counter++; // Iterate over the keys\n      // and update our new constraints\n\n      for (j = 0; j < keys.length; j++) {\n        if (tmp[keys[j]]) {\n          new_constraints[keys[j]] += tmp[keys[j]];\n        }\n      } // Push the solution into the paretos\n      // array after cleaning it of some\n      // excess data markers\n\n\n      delete tmp.feasible;\n      delete tmp.result;\n      pareto.push(tmp);\n    }\n  } // Trying to find the mid-point\n  // divide each constraint by the\n  // number of constraints\n  // *midpoint formula*\n  // (x1 + x2 + x3) / 3\n\n\n  for (i = 0; i < keys.length; i++) {\n    model.constraints[keys[i]] = {\n      \"equal\": new_constraints[keys[i]] / counter\n    };\n  } // Give the model a fake thing to optimize on\n\n\n  model.optimize = \"cheater-\" + Math.random();\n  model.opType = \"max\"; // And add the fake attribute to the variables\n  // in the model\n\n  for (i in model.variables) {\n    model.variables[i].cheater = 1;\n  } // Build out the object with all attributes\n\n\n  for (i in pareto) {\n    for (x in pareto[i]) {\n      obj[x] = obj[x] || {\n        min: 1e99,\n        max: -1e99\n      };\n    }\n  } // Give each pareto a full attribute list\n  // while getting the max and min values\n  // for each attribute\n\n\n  for (i in obj) {\n    for (x in pareto) {\n      if (pareto[x][i]) {\n        if (pareto[x][i] > obj[i].max) {\n          obj[i].max = pareto[x][i];\n        }\n\n        if (pareto[x][i] < obj[i].min) {\n          obj[i].min = pareto[x][i];\n        }\n      } else {\n        pareto[x][i] = 0;\n        obj[i].min = 0;\n      }\n    }\n  } // Solve the model for the midpoints\n\n\n  tmp = solver.Solve(model, undefined, undefined, true);\n  return {\n    midpoint: tmp,\n    vertices: pareto,\n    ranges: obj\n  };\n};","\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar agora_graph_1 = require(\"agora-graph\");\n\nvar lodash_1 = __importDefault(require(\"lodash\"));\n\nvar javascript_lp_solver_1 = require(\"javascript-lp-solver\");\n\nexports.diamondRotation = function (graph, options) {\n  if (options === void 0) {\n    options = {\n      padding: 0\n    };\n  }\n\n  var diamonds = lodash_1.default.map(graph.nodes, node2Diamond);\n  return {\n    graph: graph\n  };\n};\n\nexports.diamondGraphRotation = function (graph, options) {\n  if (options === void 0) {\n    options = {\n      padding: 0\n    };\n  }\n\n  graph.nodes.sort(function (a, b) {\n    return a.index - b.index;\n  });\n  var rotatedNodes = lodash_1.default.map(graph.nodes, function (n) {\n    var polar = agora_graph_1.toPolar(n);\n    polar.theta += Math.PI / 4;\n    var cart = agora_graph_1.toCartesian(polar);\n    return __assign(__assign({}, n), cart);\n  });\n  var vs = lodash_1.default.sortBy(rotatedNodes, 'x');\n  var hs = lodash_1.default.sortBy(rotatedNodes, 'y');\n  var diamonds = lodash_1.default.map(rotatedNodes, function (n) {\n    return node2Diamond(n, lodash_1.default.findIndex(vs, ['index', n.index]), // i'm sure it exists\n    lodash_1.default.findIndex(hs, ['index', n.index]) // i'm sure it exists\n    );\n  });\n  var constraints = []; // set minimize constraint\n\n  var minimize = lodash_1.default(diamonds).map(function (_a) {\n    var index = _a.index,\n        x = _a.x,\n        y = _a.y;\n    return \"x\" + index + \" - \" + x + \" + y\" + index + \" - \" + y;\n  }).join(' + ');\n  constraints.push('min: ' + minimize + ';'); // sort by index\n\n  diamonds.sort(function (a, b) {\n    return a.index - b.index;\n  }); // setting up orthogonal constraints\n\n  for (var i = 0; i < diamonds.length; i++) {\n    var _a = diamonds[i],\n        index = _a.index,\n        v = _a.v,\n        h = _a.h;\n\n    if (v + 1 < vs.length) {\n      // is not last\n      // x'_v(i) <= x'_v(i+1)\n      constraints.push(\"x\" + index + \" - x\" + vs[v + 1].index + \" <= 0;\");\n    }\n\n    if (h + 1 < hs.length) {\n      // is not last\n      // y'_h(i) <= y'_h(i+1)\n      constraints.push(\"y\" + index + \" - y\" + hs[h + 1].index + \" <= 0;\");\n    }\n  } // sort by x\n\n\n  diamonds.sort(function (a, b) {\n    return a.x - b.x;\n  });\n\n  for (var iIdx = 0; iIdx < diamonds.length; iIdx++) {\n    var _b = diamonds[iIdx],\n        i = _b.index,\n        yi = _b.y,\n        wi = _b.wii;\n    var ymax = null;\n    var ymin = null;\n\n    for (var jIdx = iIdx + 1; jIdx < diamonds.length; jIdx++) {\n      var _c = diamonds[jIdx],\n          j = _c.index,\n          yj = _c.y,\n          wj = _c.wii; // xj >= xi\n\n      if (yi <= yj && (ymax === null || yj <= ymax)) {\n        //wi is not width\n        constraints.push(\"x\" + j + \" - x\" + i + \" + y\" + j + \" - y\" + i + \" >= \" + (wi + wj) + \";\");\n        ymax = yj;\n      }\n\n      if (yi >= yj && (ymin === null || yj >= ymin)) {\n        constraints.push(\"x\" + j + \" - x\" + i + \" - y\" + j + \" + y\" + i + \" >= \" + (wi + wj) + \";\");\n        ymin = yj;\n      }\n    }\n  } // minimal position constraint\n\n\n  for (var index = 0; index < diamonds.length; index++) {\n    var _d = diamonds[index],\n        i = _d.index,\n        x = _d.x,\n        y = _d.y;\n    constraints.push(\"x\" + i + \" >= \" + x + \";\");\n    constraints.push(\"y\" + i + \" >= \" + y + \";\");\n  } // transform to js constraint\n\n\n  var lpsolve = constraints.join('\\n');\n  var tmodel = javascript_lp_solver_1.ReformatLP(lpsolve); // console.log(lpsolve);\n\n  var solver = javascript_lp_solver_1.Solve(tmodel);\n\n  var feasible = solver.feasible,\n      result = solver.result,\n      bounded = solver.bounded,\n      rest = __rest(solver, [\"feasible\", \"result\", \"bounded\"]); // index => {x?: y:?}\n\n\n  var positions = lodash_1.default.transform(rest, function (result, val, key) {\n    var tpe = key.substr(0, 1);\n    var index = key.substr(1);\n    (result[index] || (result[index] = {}))[tpe] = val;\n  }, {}); // rotate back to cartesian\n\n  var rotatedPos = {};\n  lodash_1.default.forEach(diamonds, function (_a) {\n    var index = _a.index,\n        x = _a.x,\n        y = _a.y;\n    var position = {\n      x: positions[index] && positions[index].x ? positions[index].x : x,\n      y: positions[index] && positions[index].y ? positions[index].y : y\n    };\n    var polar = agora_graph_1.toPolar(position);\n    polar.theta -= Math.PI / 4;\n    rotatedPos[index] = agora_graph_1.toCartesian(polar);\n  }); // map to nodes\n\n  var updatedNodes = lodash_1.default.map(graph.nodes, function (_a) {\n    var index = _a.index,\n        x = _a.x,\n        y = _a.y,\n        rest = __rest(_a, [\"index\", \"x\", \"y\"]);\n\n    return __assign(__assign({\n      index: index\n    }, rest), rotatedPos[index]);\n  }); // console.log(JSON.stringify(graph));\n  // console.log(JSON.stringify(diamonds));\n  // console.log(\n  //   JSON.stringify(\n  //     diamonds.map(({ wii: width, height, ...d }) => {\n  //       const update: any = {};\n  //       if (positions[d.index]) {\n  //         if (positions[d.index].x) update.x = positions[d.index].x;\n  //         if (positions[d.index].y) update.y = positions[d.index].y;\n  //       }\n  //       return { ...d, ...update, width: width * 2, height: height * 2 };\n  //     })\n  //   )\n  // );\n\n  return {\n    graph: {\n      nodes: updatedNodes,\n      edges: graph.edges\n    }\n  };\n};\n\nfunction node2Diamond(_a, v, h) {\n  var x = _a.x,\n      y = _a.y,\n      width = _a.width,\n      height = _a.height,\n      index = _a.index;\n  return {\n    index: index,\n    x: x,\n    y: y,\n    v: v,\n    h: h,\n    wii: Math.max(height, width) / 2 * Math.SQRT2\n  };\n}"],"sourceRoot":""}